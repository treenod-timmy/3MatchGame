<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KÌåù Ïä§ÌÉÄ Ïú°ÏÑ± Í≤åÏûÑ</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #ff6b9d, #c44569, #4834d4, #686de0);
            font-family: 'Arial', sans-serif;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ÌôîÎ©¥ Ï†ÑÌôò */
        .screen {
            display: none;
            min-height: 100vh;
            padding: 20px;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* ===== Ìôà ÌôîÎ©¥ Ïä§ÌÉÄÏùº ===== */
        .home-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .home-title {
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin: 0;
            background: linear-gradient(45deg, #fff, #ffd700, #ff69b4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .home-subtitle {
            font-size: 1.2em;
            margin-top: 10px;
            opacity: 0.9;
        }

        /* Ïú°ÏÑ±Î£∏ Ïä§ÌÉÄÏùº */
        .training-room {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        /* Í±∏Í∑∏Î£π Î©§Î≤ÑÎì§ */
        .girl-group {
            display: flex;
            justify-content: center;
            align-items: end;
            gap: 60px;
            margin-bottom: 30px;
            position: relative;
        }

        .member {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .member:hover {
            transform: translateY(-10px);
        }

        .member-avatar {
            width: 120px;
            height: 160px;
            border-radius: 20px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            margin-bottom: 15px;
            box-shadow: none;
            position: relative;
            overflow: hidden;
            border: none;
        }

        /* ÏÑúÏó∞ - Ïã§Ï†ú Ïù¥ÎØ∏ÏßÄ Ï†ÅÏö© */
        .member:nth-child(1) .member-avatar {
            background-image: url('./Res/seoyeon.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .member:nth-child(1) .member-avatar .motion-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            pointer-events: none;
            object-fit: contain;
            border-radius: 20px;
            transition: opacity 0.3s ease;
        }

        .member:nth-child(1) .member-avatar .motion-video.playing {
            opacity: 1;
        }

        .member:nth-child(1) .member-avatar::before {
            content: '';
        }

        /* ÎØºÏßÄ - Ïã§Ï†ú Ïù¥ÎØ∏ÏßÄ Ï†ÅÏö© (ÏÑºÌÑ∞) */
        .member:nth-child(2) .member-avatar {
            background-image: url('./Res/minji.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: transparent;
            transform: scale(1.1);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .member:nth-child(2) .member-avatar .motion-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            pointer-events: none;
            object-fit: contain;
            border-radius: 20px;
            transition: opacity 0.3s ease;
        }

        .member:nth-child(2) .member-avatar .motion-video.playing {
            opacity: 1;
        }

        .member:nth-child(2) .member-avatar::before {
            content: '';
        }

        .member:nth-child(2) .member-avatar::after {
            content: '';
        }

        /* ÌïòÏó∞ - Ïã§Ï†ú Ïù¥ÎØ∏ÏßÄ Ï†ÅÏö© */
        .member:nth-child(3) .member-avatar {
            background-image: url('./Res/hayeon.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .member:nth-child(3) .member-avatar .motion-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            pointer-events: none;
            object-fit: contain;
            border-radius: 20px;
            transition: opacity 0.3s ease;
        }

        .member:nth-child(3) .member-avatar .motion-video.playing {
            opacity: 1;
        }

        /* ÎåÄÏ≤¥ Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes memberClick {
            0% { 
                transform: scale(1) rotate(0deg); 
                filter: brightness(1);
            }
            25% { 
                transform: scale(1.1) rotate(-3deg); 
                filter: brightness(1.2);
            }
            50% { 
                transform: scale(1.15) rotate(3deg); 
                filter: brightness(1.3);
            }
            75% { 
                transform: scale(1.05) rotate(-1deg); 
                filter: brightness(1.1);
            }
            100% { 
                transform: scale(1) rotate(0deg); 
                filter: brightness(1);
            }
        }

        .member:nth-child(3) .member-avatar::before {
            content: '';
        }

        .member:nth-child(3) .member-avatar::after {
            content: '';
        }

        /* Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥ºÎì§ */
        @keyframes centerShine {
            0% { filter: brightness(1) drop-shadow(0 0 5px rgba(255,215,0,0.3)); }
            100% { filter: brightness(1.2) drop-shadow(0 0 15px rgba(255,215,0,0.6)); }
        }

        @keyframes danceMove {
            0%, 100% { transform: translateX(-50%) rotate(-2deg); }
            50% { transform: translateX(-50%) rotate(2deg); }
        }

        /* Ìò∏Î≤Ñ Ìö®Í≥º */
        .member:hover .member-avatar {
            transform: translateY(-8px);
            box-shadow: none;
            border: none;
        }

        .member:nth-child(2):hover .member-avatar {
            transform: translateY(-8px) scale(1.15);
            box-shadow: none;  
            border: none;
        }

        .member:hover .member-avatar::before {
            filter: brightness(1.3);
        }

        .member:hover .member-avatar::after {
            filter: brightness(1.1);
        }

        .member-name {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .member-level {
            font-size: 0.9em;
            background: rgba(255, 215, 0, 0.2);
            padding: 3px 10px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        /* Ïä§ÌÖü Î∞î */
        .member-stats {
            margin-top: 10px;
            width: 100px;
        }

        .stat-row {
            display: flex;
            align-items: center;
            margin: 2px 0;
        }

        .stat-icon {
            width: 16px;
            height: 16px;
            margin-right: 4px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 4px;
            border-radius: 2px;
            flex: 1;
            overflow: hidden;
        }

        .stat-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 0.5s ease;
        }

        .hp { background: linear-gradient(90deg, #ff4757, #ff6b7a); }
        .emotion { background: linear-gradient(90deg, #ff9ff3, #f368e0); }
        .vocal { background: linear-gradient(90deg, #3742fa, #5352ed); }
        .dance { background: linear-gradient(90deg, #2ed573, #7bed9f); }
        .expression { background: linear-gradient(90deg, #ffa502, #ff6348); }
        .power { background: linear-gradient(90deg, #8e44ad, #9c88ff); }

        /* Ìôà UI */
        .home-ui {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-width: 100px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffd700;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }

        /* Î≤ÑÌäºÎì§ */
        .home-buttons {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .btn.primary {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            color: #333;
        }

        /* ===== Í≤åÏûÑ ÌôîÎ©¥ Ïä§ÌÉÄÏùº ===== */
        .game-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .game-title {
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin: 0;
            background: linear-gradient(45deg, #fff, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-board {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .score-item {
            display: inline-block;
            margin: 0 20px;
            text-align: center;
        }

        .score-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .score-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffd700;
        }

        .score-target {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.7);
            margin-top: -5px;
        }

        .game-board {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(8, 60px);
            grid-template-rows: repeat(8, 60px);
            gap: 3px;
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 15px;
        }

        .cell {
            width: 60px;
            height: 60px;
            background: #f0f0f0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 0 rgba(255,255,255,0.3), 0 2px 6px rgba(0,0,0,0.2);
        }

        .cell:hover {
            transform: translateY(-2px);
            box-shadow: inset 0 2px 0 rgba(255,255,255,0.3), 0 6px 12px rgba(0,0,0,0.3);
        }

        .cell:active {
            transform: translateY(1px);
            box-shadow: inset 0 2px 0 rgba(255,255,255,0.3), 0 1px 3px rgba(0,0,0,0.3);
        }

        .cell.drag-start {
            transform: scale(1.1);
            box-shadow: 
                inset 0 2px 0 rgba(255,255,255,0.5),
                0 0 0 2px #00ff88,
                0 6px 16px rgba(0,255,136,0.3);
        }

        .cell.dragging {
            transform: scale(1.15);
            z-index: 1000;
            box-shadow: 
                inset 0 2px 0 rgba(255,255,255,0.3),
                0 8px 25px rgba(0,0,0,0.4);
            opacity: 0.8;
        }

        .cell.drag-target {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            transform: scale(1.1);
            box-shadow: 
                inset 0 2px 0 rgba(255,255,255,0.5),
                0 0 0 4px #ffd700,
                0 8px 20px rgba(255,215,0,0.6);
            animation: dragTargetPulse 0.5s infinite alternate;
        }

        @keyframes dragTargetPulse {
            0% {
                box-shadow: 
                    inset 0 2px 0 rgba(255,255,255,0.5),
                    0 0 0 4px #ffd700,
                    0 8px 20px rgba(255,215,0,0.6);
                transform: scale(1.1);
            }
            100% {
                box-shadow: 
                    inset 0 2px 0 rgba(255,255,255,0.5),
                    0 0 0 4px #ffed4a,
                    0 8px 20px rgba(255,215,0,0.8);
                transform: scale(1.15);
            }
        }

        .block {
            width: 55px;
            height: 55px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0px;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
            position: relative;
            box-shadow: 
                inset 0 2px 0 rgba(255,255,255,0.2),
                0 2px 4px rgba(0,0,0,0.2);
            color: transparent;
            text-indent: -9999px;
            overflow: hidden;
            line-height: 0;
        }

        .block.mic {
            background-image: url('./Res/block-mic.png');
            background-size: 180%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: transparent;
            color: transparent;
            font-size: 0;
        }

        .block.headphones {
            background-image: url('./Res/block-gui.png');
            background-size: 180%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: transparent;
            color: transparent;
            font-size: 0;
        }

        .block.lightstick {
            background-image: url('./Res/block-lightstick.png');
            background-size: 180%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: transparent;
            color: transparent;
            font-size: 0;
        }

        .block.note {
            background-image: url('./Res/block-sho.png');
            background-size: 180%;
            background-position: center;
            background-repeat: no-repeat;
            background-color: transparent;
            color: transparent;
            font-size: 0;
        }

        .cell:hover .block {
            transform: scale(1.1);
            box-shadow: 
                inset 0 2px 0 rgba(255,255,255,0.3),
                0 4px 8px rgba(0,0,0,0.3);
        }

        .cell:active .block {
            transform: scale(0.95);
            box-shadow: 
                inset 0 1px 0 rgba(255,255,255,0.2),
                0 1px 2px rgba(0,0,0,0.2);
        }

        .game-controls {
            margin-top: 20px;
            text-align: center;
        }

        /* Ïù¥ÌéôÌä∏Îì§ */
        .match-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            pointer-events: none;
            z-index: 100;
        }

        .match-explosion {
            animation: explosionEffect 0.8s ease-out forwards;
        }

        @keyframes explosionEffect {
            0% {
                background: radial-gradient(circle, rgba(255,255,255,0) 0%, rgba(255,255,255,0) 100%);
                transform: scale(1);
                opacity: 1;
            }
            15% {
                background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,215,0,0.9) 30%, rgba(255,69,0,0.8) 60%, transparent 100%);
                transform: scale(1.3);
                opacity: 1;
            }
            40% {
                background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,140,0,0.7) 40%, rgba(255,0,128,0.6) 70%, transparent 100%);
                transform: scale(1.8);
                opacity: 0.9;
            }
            70% {
                background: radial-gradient(circle, transparent 0%, rgba(255,69,0,0.4) 50%, rgba(138,43,226,0.3) 80%, transparent 100%);
                transform: scale(2.5);
                opacity: 0.6;
            }
            100% {
                background: radial-gradient(circle, transparent 0%, transparent 100%);
                transform: scale(3.5);
                opacity: 0;
            }
        }

        .sparkle-burst {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 4px;
            background: #ffd700;
            border-radius: 50%;
            pointer-events: none;
        }

        .sparkle-1 { animation: sparkleExplode 0.8s ease-out; transform: translate(-50%, -50%) rotate(0deg); }
        .sparkle-2 { animation: sparkleExplode 0.8s ease-out 0.1s; transform: translate(-50%, -50%) rotate(45deg); }
        .sparkle-3 { animation: sparkleExplode 0.8s ease-out 0.2s; transform: translate(-50%, -50%) rotate(90deg); }
        .sparkle-4 { animation: sparkleExplode 0.8s ease-out 0.15s; transform: translate(-50%, -50%) rotate(135deg); }
        .sparkle-5 { animation: sparkleExplode 0.8s ease-out 0.05s; transform: translate(-50%, -50%) rotate(180deg); }
        .sparkle-6 { animation: sparkleExplode 0.8s ease-out 0.25s; transform: translate(-50%, -50%) rotate(225deg); }
        .sparkle-7 { animation: sparkleExplode 0.8s ease-out 0.3s; transform: translate(-50%, -50%) rotate(270deg); }
        .sparkle-8 { animation: sparkleExplode 0.8s ease-out 0.2s; transform: translate(-50%, -50%) rotate(315deg); }

        @keyframes sparkleExplode {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1) translateY(0);
                box-shadow: 0 0 4px #ffd700;
            }
            50% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.5) translateY(-30px);
                box-shadow: 0 0 8px #ffd700, 0 0 16px rgba(255,215,0,0.6);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5) translateY(-60px);
                box-shadow: 0 0 2px #ffd700;
            }
        }

        .cell.destroying {
            animation: blockDestroy 0.8s ease-out forwards;
        }

        @keyframes blockDestroy {
            0% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
            30% {
                transform: scale(1.2) rotate(10deg);
                opacity: 1;
            }
            60% {
                transform: scale(0.8) rotate(-5deg);
                opacity: 0.7;
            }
            100% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
        }

        .screen-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            pointer-events: none;
            z-index: 9999;
            opacity: 0;
            animation: screenFlash 0.4s ease-out;
        }

        @keyframes screenFlash {
            0% { opacity: 0; }
            20% { opacity: 1; }
            100% { opacity: 0; }
        }

        .coin-effect {
            position: absolute;
            font-size: 24px;
            color: #ffd700;
            font-weight: bold;
            pointer-events: none;
            z-index: 200;
            text-shadow: 
                0 0 10px rgba(255, 215, 0, 0.8),
                2px 2px 4px rgba(0,0,0,0.5);
            animation: coinFloat 1.5s ease-out forwards;
        }

        @keyframes coinFloat {
            0% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
            50% {
                opacity: 1;
                transform: scale(1.3) translateY(-20px);
            }
            100% {
                opacity: 0;
                transform: scale(1) translateY(-50px);
            }
        }

        /* ÌÅ¥Î¶¨Ïñ¥ Ïò§Î≤ÑÎ†àÏù¥ */
        .clear-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            animation: clearFadeIn 0.5s ease-out forwards;
        }

        .clear-message {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 60px 80px;
            border-radius: 25px;
            text-align: center;
            color: white;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 3px solid rgba(255, 255, 255, 0.3);
            transform: scale(0.8);
            animation: clearPop 0.6s ease-out 0.3s forwards;
        }

        .clear-title {
            font-size: 4em;
            font-weight: bold;
            margin: 0 0 20px 0;
            text-shadow: 
                0 0 20px rgba(255, 255, 255, 0.8),
                3px 3px 6px rgba(0,0,0,0.5);
            background: linear-gradient(45deg, #ffd700, #fff, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: clearGlow 2s infinite alternate;
        }

        .clear-stats {
            font-size: 1.3em;
            margin: 20px 0;
            opacity: 0;
            animation: clearStatsShow 0.8s ease-out 0.8s forwards;
        }

        .clear-button {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            border: none;
            color: #333;
            padding: 15px 40px;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
            opacity: 0;
            animation: clearButtonShow 0.8s ease-out 1.2s forwards;
        }

        .clear-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(255, 215, 0, 0.5);
        }

        @keyframes clearFadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        @keyframes clearPop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes clearGlow {
            0% { text-shadow: 0 0 20px rgba(255, 255, 255, 0.8), 3px 3px 6px rgba(0,0,0,0.5); }
            100% { text-shadow: 0 0 30px rgba(255, 255, 255, 1), 3px 3px 6px rgba(0,0,0,0.5); }
        }

        @keyframes clearStatsShow {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        @keyframes clearButtonShow {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        /* ===== Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ Ïä§ÌÉÄÏùº ===== */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff6b9d, #c44569, #4834d4, #686de0);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        .splash-screen.fade-out {
            opacity: 0;
        }

        .splash-logo {
            width: 300px;
            height: 300px;
            background-image: url('./Res/splash.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            margin-bottom: 30px;
            animation: splashPulse 2s infinite ease-in-out;
        }

        .splash-title {
            font-size: 3em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
            background: linear-gradient(45deg, #fff, #ffd700, #ff69b4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: splashGlow 2s infinite alternate;
        }

        .splash-subtitle {
            font-size: 1.2em;
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            opacity: 0;
            animation: splashFadeIn 1s ease-out 1s forwards;
        }

        .loading-dots {
            margin-top: 30px;
            display: flex;
            gap: 10px;
        }

        .loading-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.8);
            animation: loadingBounce 1.4s infinite ease-in-out both;
        }

        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }
        .loading-dot:nth-child(3) { animation-delay: 0s; }

        @keyframes splashPulse {
            0%, 100% { 
                transform: scale(1);
                filter: brightness(1);
            }
            50% { 
                transform: scale(1.05);
                filter: brightness(1.1);
            }
        }

        @keyframes splashGlow {
            0% { 
                text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 20px rgba(255,215,0,0.3);
            }
            100% { 
                text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 30px rgba(255,215,0,0.6);
            }
        }

        @keyframes splashFadeIn {
            0% { 
                opacity: 0;
                transform: translateY(20px);
            }
            100% { 
                opacity: 0.9;
                transform: translateY(0);
            }
        }

        @keyframes loadingBounce {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }

        /* ===== ÌõàÎ†® ÏÑºÌÑ∞ Ïä§ÌÉÄÏùº ===== */
        .training-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .training-category {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .training-category:hover:not(.disabled) {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .training-category.disabled {
            opacity: 0.5;
            filter: grayscale(50%);
        }

        .category-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .training-category h3 {
            font-size: 1.5em;
            margin: 15px 0 10px 0;
            color: #ffd700;
        }

        .training-category p {
            margin: 0 0 20px 0;
            opacity: 0.8;
        }

        /* ===== Îã¨Î¶¨Í∏∞ Í≤åÏûÑ Ïä§ÌÉÄÏùº ===== */
        .running-game {
            max-width: 800px;
            margin: 0 auto;
        }

        .running-track {
            background: linear-gradient(180deg, #87CEEB 0%, #32CD32 50%, #228B22 100%);
            height: 200px;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
            border: 3px solid rgba(255, 255, 255, 0.3);
        }

        .runner {
            position: absolute;
            left: 50px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 3em;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .runner.running {
            animation: runningBounce 0.3s ease-in-out;
        }

        @keyframes runningBounce {
            0%, 100% { transform: translateY(-50%) scale(1); }
            50% { transform: translateY(-60%) scale(1.1); }
        }

        .finish-line {
            position: absolute;
            right: 30px;
            top: 20px;
            font-size: 2em;
            animation: finishFlag 2s infinite ease-in-out;
        }

        @keyframes finishFlag {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .progress-bar {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ffd700, #ff6b9d);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .running-ui {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .stamina-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            margin-top: 8px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }

        .stamina-fill {
            height: 100%;
            width: 100%;
            border-radius: 4px;
            transition: all 0.3s ease;
            background: linear-gradient(90deg, #00ff88, #00cc6a);
            box-shadow: 0 0 10px rgba(0,255,136,0.5);
        }

        .stamina-fill.medium {
            background: linear-gradient(90deg, #ffd700, #ffed4a);
            box-shadow: 0 0 10px rgba(255,215,0,0.5);
        }

        .stamina-fill.low {
            background: linear-gradient(90deg, #ff4757, #ff3742);
            box-shadow: 0 0 10px rgba(255,71,87,0.5);
            animation: staminaWarning 0.8s infinite alternate;
        }

        .stamina-fill.critical {
            background: linear-gradient(90deg, #dc143c, #8b0000);
            box-shadow: 0 0 15px rgba(220,20,60,0.8);
            animation: staminaCritical 0.4s infinite alternate;
        }

        @keyframes staminaWarning {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }

        @keyframes staminaCritical {
            0% {
                opacity: 0.7;
                box-shadow: 0 0 15px rgba(220,20,60,0.8);
            }
            100% {
                opacity: 1;
                box-shadow: 0 0 25px rgba(220,20,60,1), 0 0 35px rgba(255,0,0,0.5);
            }
        }

        .running-controls {
            text-align: center;
        }

        .running-btn {
            font-size: 1.5em;
            padding: 20px 40px;
            margin-bottom: 20px;
            transition: all 0.2s ease;
        }

        .running-btn:active {
            transform: scale(0.95);
        }

        .running-btn.perfect {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            animation: perfectPulse 0.3s ease-out;
        }

        .running-btn.good {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            animation: goodPulse 0.3s ease-out;
        }

        .running-btn.bad {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            animation: badShake 0.3s ease-out;
        }

        @keyframes perfectPulse {
            0% { transform: scale(1); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
            50% { transform: scale(1.1); box-shadow: 0 8px 30px rgba(0,255,136,0.5); }
            100% { transform: scale(1); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        }

        @keyframes goodPulse {
            0% { transform: scale(1); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
            50% { transform: scale(1.05); box-shadow: 0 8px 25px rgba(255,215,0,0.5); }
            100% { transform: scale(1); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        }

        @keyframes badShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .instructions p {
            margin: 5px 0;
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* ===== Î¨¥ÎåÄ Ïä§ÌÖåÏù¥ÏßÄ Ïä§ÌÉÄÏùº ===== */
        .stage-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .stage-backdrop {
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 30%, #0f3460 70%, #533483 100%);
            border-radius: 25px;
            padding: 40px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            border: 3px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 30px;
        }

        .stage-lights {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: 
                radial-gradient(circle at 40% 50%, rgba(255,0,255,0.8) 0%, transparent 15%),
                radial-gradient(circle at 60% 50%, rgba(0,255,255,0.8) 0%, transparent 15%),
                radial-gradient(circle at 80% 50%, rgba(255,255,0,0.8) 0%, transparent 15%);
            animation: stageLights 3s infinite ease-in-out;
        }

        @keyframes stageLights {
            0%, 100% { 
                opacity: 0.8;
                filter: brightness(1);
            }
            50% { 
                opacity: 1;
                filter: brightness(1.5);
            }
        }

        .stage-platform {
            background: linear-gradient(180deg, rgba(255,255,255,0.1) 0%, rgba(0,0,0,0.2) 100%);
            border-radius: 15px;
            padding: 30px;
            margin-top: 40px;
            backdrop-filter: blur(10px);
            position: relative;
        }

        .stage-members {
            display: flex;
            justify-content: center;
            align-items: end;
            gap: 80px;
            margin-bottom: 40px;
            position: relative;
        }

        .stage-member {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            transition: all 0.5s ease;
        }

        .stage-member.center {
            transform: scale(1.1);
            z-index: 10;
        }

        .member-stage-avatar {
            width: 100px;
            height: 130px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            box-shadow: 
                0 15px 40px rgba(0,0,0,0.5),
                inset 0 2px 0 rgba(255,255,255,0.3);
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.4);
        }

        .member-stage-avatar::before {
            content: '';
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.4) 30%, transparent 70%);
            border-radius: 50%;
            animation: spotlightPulse 3s infinite ease-in-out;
            z-index: 10;
            pointer-events: none;
        }

        @keyframes spotlightPulse {
            0%, 100% { 
                opacity: 0.6;
                transform: translateX(-50%) scale(1);
            }
            50% { 
                opacity: 1;
                transform: translateX(-50%) scale(1.2);
            }
        }

        /* ÏÑúÏó∞ - Î¨¥ÎåÄ Î≤ÑÏ†Ñ Ïù¥ÎØ∏ÏßÄ Ï†ÅÏö© */
        .seoyeon-stage {
            background-image: url('./Res/seoyeon.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #87CEEB;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .seoyeon-stage::before {
            background: radial-gradient(circle, rgba(135,206,235,0.3) 0%, rgba(70,130,180,0.2) 30%, transparent 70%);
        }

        /* ÎØºÏßÄ - Î¨¥ÎåÄ Î≤ÑÏ†Ñ Ïù¥ÎØ∏ÏßÄ Ï†ÅÏö© (ÏÑºÌÑ∞) */
        .minji-stage {
            background-image: url('./Res/minji.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #FFB6C1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .minji-stage::before {
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, rgba(255,105,180,0.2) 30%, transparent 70%);
        }

        /* ÌïòÏó∞ - Î¨¥ÎåÄ Î≤ÑÏ†Ñ Ïù¥ÎØ∏ÏßÄ Ï†ÅÏö© */
        .hayeon-stage {
            background-image: url('./Res/hayeon.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #FFB6C1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .hayeon-stage::before {
            background: radial-gradient(circle, rgba(255,20,147,0.3) 0%, rgba(220,20,60,0.2) 30%, transparent 70%);
        }

        .member-stage-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            background: rgba(0,0,0,0.3);
            padding: 5px 15px;
            border-radius: 15px;
            backdrop-filter: blur(5px);
        }

        .performance-ui {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .performance-stats {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .performance-controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .performance-btn {
            font-size: 1.3em;
            padding: 15px 30px;
            position: relative;
            overflow: hidden;
        }

        .performance-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: buttonShine 2s infinite;
        }

        @keyframes buttonShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .performance-progress {
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(5px);
        }

        .progress-section {
            margin-bottom: 20px;
        }

        .progress-section h3 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }

        .song-progress {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
        }

        .song-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .song-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff6b9d, #c44569, #4834d4);
            border-radius: 4px;
            transition: width 0.5s ease;
            animation: songProgress 1s infinite ease-in-out;
        }

        @keyframes songProgress {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        .song-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            color: rgba(255,255,255,0.8);
        }

        .live-reactions {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
        }

        .reaction-feed {
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
        }

        .reaction {
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            margin: 5px 0;
            border-radius: 20px;
            font-size: 0.9em;
            animation: reactionFadeIn 0.5s ease-out;
        }

        @keyframes reactionFadeIn {
            0% { 
                opacity: 0;
                transform: translateY(20px);
            }
            100% { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stage-member.dancing {
            animation: stagePerformance 1s ease-in-out;
        }

        @keyframes stagePerformance {
            0%, 100% { transform: translateY(0) scale(1); }
            25% { transform: translateY(-10px) scale(1.05); }
            50% { transform: translateY(-5px) scale(1.1); }
            75% { transform: translateY(-15px) scale(1.05); }
        }

        .stage-member.center.dancing {
            animation: centerPerformance 1s ease-in-out;
        }

        @keyframes centerPerformance {
            0%, 100% { transform: scale(1.1) translateY(0); }
            25% { transform: scale(1.15) translateY(-15px); }
            50% { transform: scale(1.2) translateY(-10px); }
            75% { transform: scale(1.15) translateY(-20px); }
        }

        .lyrics {
            text-align: center;
            margin-top: 20px;
        }

        .lyrics-container {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .current-lyric {
            font-size: 2em;
            font-weight: 900;
            color: #ffd700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            text-align: center;
        }

        .next-lyric {
            font-size: 1em;
            color: rgba(255,255,255,0.7);
            opacity: 0.8;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-logo"></div>
        <h1 class="splash-title">üåü STARLIGHT GIRLS</h1>
        <p class="splash-subtitle">K-POP Ïä§ÌÉÄÎ•º Ïú°ÏÑ±ÌïòÏÑ∏Ïöî!</p>
        <div class="loading-dots">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
        </div>
    </div>

    <!-- Ìôà ÌôîÎ©¥ -->
    <div id="homeScreen" class="screen">
        <div class="home-header">
            <h1 class="home-title">üåü STARLIGHT GIRLS</h1>
            <p class="home-subtitle">K-POP Ïä§ÌÉÄÎ•º Ïú°ÏÑ±ÌïòÏÑ∏Ïöî!</p>
        </div>
        
        <div class="training-room">
            <div class="girl-group">
                <div class="member" onclick="selectMember(0)">
                    <div class="member-avatar">
                        <video class="motion-video" muted preload="auto">
                            <source src="./Res/seoyeon-motion.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="member-name">ÏÑúÏó∞</div>
                    <div class="member-level">Lv.1</div>
                    <div class="member-stats">
                        <div class="stat-row">
                            <div class="stat-icon">‚ù§Ô∏è</div>
                            <div class="stat-bar"><div class="stat-fill hp" style="width: 65%" id="seoyeon-hp"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üòä</div>
                            <div class="stat-bar"><div class="stat-fill emotion" style="width: 85%" id="seoyeon-emotion"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üé§</div>
                            <div class="stat-bar"><div class="stat-fill vocal" style="width: 70%" id="seoyeon-vocal"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üíÉ</div>
                            <div class="stat-bar"><div class="stat-fill dance" style="width: 55%" id="seoyeon-dance"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üòç</div>
                            <div class="stat-bar"><div class="stat-fill expression" style="width: 90%" id="seoyeon-expression"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">‚ö°</div>
                            <div class="stat-bar"><div class="stat-fill power" style="width: 60%" id="seoyeon-power"></div></div>
                        </div>
                    </div>
                </div>

                <div class="member" onclick="selectMember(1)">
                    <div class="member-avatar">
                        <video class="motion-video" muted preload="auto">
                            <source src="./Res/minji-motion.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="member-name">ÎØºÏßÄ</div>
                    <div class="member-level">Lv.1</div>
                    <div class="member-stats">
                        <div class="stat-row">
                            <div class="stat-icon">‚ù§Ô∏è</div>
                            <div class="stat-bar"><div class="stat-fill hp" style="width: 75%" id="minji-hp"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üòä</div>
                            <div class="stat-bar"><div class="stat-fill emotion" style="width: 70%" id="minji-emotion"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üé§</div>
                            <div class="stat-bar"><div class="stat-fill vocal" style="width: 95%" id="minji-vocal"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üíÉ</div>
                            <div class="stat-bar"><div class="stat-fill dance" style="width: 65%" id="minji-dance"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üòç</div>
                            <div class="stat-bar"><div class="stat-fill expression" style="width: 75%" id="minji-expression"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">‚ö°</div>
                            <div class="stat-bar"><div class="stat-fill power" style="width: 90%" id="minji-power"></div></div>
                        </div>
                    </div>
                </div>

                <div class="member" onclick="selectMember(2)">
                    <div class="member-avatar">
                        <video class="motion-video" muted preload="auto">
                            <source src="./Res/hayeon-motion.mp4" type="video/mp4">
                        </video>
                    </div>
                    <div class="member-name">ÌïòÏó∞</div>
                    <div class="member-level">Lv.1</div>
                    <div class="member-stats">
                        <div class="stat-row">
                            <div class="stat-icon">‚ù§Ô∏è</div>
                            <div class="stat-bar"><div class="stat-fill hp" style="width: 95%" id="hayeon-hp"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üòä</div>
                            <div class="stat-bar"><div class="stat-fill emotion" style="width: 80%" id="hayeon-emotion"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üé§</div>
                            <div class="stat-bar"><div class="stat-fill vocal" style="width: 55%" id="hayeon-vocal"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üíÉ</div>
                            <div class="stat-bar"><div class="stat-fill dance" style="width: 100%" id="hayeon-dance"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">üòç</div>
                            <div class="stat-bar"><div class="stat-fill expression" style="width: 85%" id="hayeon-expression"></div></div>
                        </div>
                        <div class="stat-row">
                            <div class="stat-icon">‚ö°</div>
                            <div class="stat-bar"><div class="stat-fill power" style="width: 70%" id="hayeon-power"></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="home-ui">
            <div class="stat-card">
                <div class="stat-value" id="totalCoins">0</div>
                <div class="stat-label">üí∞ ÏΩîÏù∏</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="completedLevels">0</div>
                <div class="stat-label">üèÜ ÌÅ¥Î¶¨Ïñ¥</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="groupLevel">1</div>
                <div class="stat-label">üëë Í∑∏Î£π Î†àÎ≤®</div>
            </div>
        </div>

        <div class="home-buttons">
            <button class="btn primary" onclick="startGame()">üéÆ Í≤åÏûÑ ÏãúÏûë</button>
            <button class="btn" onclick="openTraining()">üí™ ÌõàÎ†®ÌïòÍ∏∞</button>
            <button class="btn" onclick="openShop()">üõçÔ∏è ÏÉÅÏ†ê</button>
            <button class="btn primary" onclick="startAlbumDebut()">üé§ Ïï®Î≤î Îç∞Î∑î!</button>
        </div>
    </div>

    <!-- ÌõàÎ†® ÏÑ†ÌÉù ÌôîÎ©¥ -->
    <div id="trainingScreen" class="screen">
        <div class="home-header">
            <h1 class="home-title">üí™ ÌõàÎ†® ÏÑºÌÑ∞</h1>
            <p class="home-subtitle">Î©§Î≤ÑÎì§Ïùò Îä•Î†•ÏùÑ Ìñ•ÏÉÅÏãúÌÇ§ÏÑ∏Ïöî!</p>
            <button class="btn" onclick="goHome()" style="position: absolute; top: 20px; right: 20px;">ÌôàÏúºÎ°ú</button>
        </div>

        <div class="training-menu">
            <div class="training-category">
                <div class="category-icon">üèÉ‚Äç‚ôÄÔ∏è</div>
                <h3>Ï≤¥Î†• ÌõàÎ†®</h3>
                <p>Îã¨Î¶¨Í∏∞Î•º ÌÜµÌï¥ Ï≤¥Î†•ÏùÑ Ìñ•ÏÉÅÏãúÌÇµÎãàÎã§</p>
                <button class="btn primary" onclick="startRunningGame()">üèÉ‚Äç‚ôÄÔ∏è Îã¨Î¶¨Í∏∞ ÏãúÏûë</button>
            </div>

            <div class="training-category disabled">
                <div class="category-icon">üòä</div>
                <h3>Í∞êÏÑ± ÌõàÎ†®</h3>
                <p>Ï§ÄÎπÑ Ï§ë...</p>
                <button class="btn" disabled>Ï§ÄÎπÑÏ§ë</button>
            </div>

            <div class="training-category disabled">
                <div class="category-icon">üé§</div>
                <h3>Î≥¥Ïª¨ ÌõàÎ†®</h3>
                <p>Ï§ÄÎπÑ Ï§ë...</p>
                <button class="btn" disabled>Ï§ÄÎπÑÏ§ë</button>
            </div>

            <div class="training-category disabled">
                <div class="category-icon">üíÉ</div>
                <h3>ÎåÑÏä§ ÌõàÎ†®</h3>
                <p>Ï§ÄÎπÑ Ï§ë...</p>
                <button class="btn" disabled>Ï§ÄÎπÑÏ§ë</button>
            </div>

            <div class="training-category disabled">
                <div class="category-icon">üòç</div>
                <h3>ÌëúÏ†ï ÌõàÎ†®</h3>
                <p>Ï§ÄÎπÑ Ï§ë...</p>
                <button class="btn" disabled>Ï§ÄÎπÑÏ§ë</button>
            </div>

            <div class="training-category disabled">
                <div class="category-icon">‚ö°</div>
                <h3>ÌååÏõå ÌõàÎ†®</h3>
                <p>Ï§ÄÎπÑ Ï§ë...</p>
                <button class="btn" disabled>Ï§ÄÎπÑÏ§ë</button>
            </div>
        </div>
    </div>

    <!-- Îã¨Î¶¨Í∏∞ Í≤åÏûÑ ÌôîÎ©¥ -->
    <div id="runningGameScreen" class="screen">
        <div class="game-header">
            <h1 class="game-title">üèÉ‚Äç‚ôÄÔ∏è Ï≤¥Î†• ÌõàÎ†® - Îã¨Î¶¨Í∏∞</h1>
            <button class="btn" onclick="exitRunningGame()" style="position: absolute; top: 20px; right: 20px;">ÎÇòÍ∞ÄÍ∏∞</button>
        </div>

        <div class="running-game">
            <div class="running-track">
                <div class="runner" id="runner">üèÉ‚Äç‚ôÄÔ∏è</div>
                <div class="finish-line">üèÅ</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="runProgress"></div>
                </div>
            </div>

            <div class="running-ui">
                <div class="stat-card">
                    <div class="stat-value" id="runDistance">0m</div>
                    <div class="stat-label">Í±∞Î¶¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="runSpeed">0</div>
                    <div class="stat-label">ÏÜçÎèÑ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="runStamina">100</div>
                    <div class="stat-label">Ïä§ÌÉúÎØ∏ÎÇò</div>
                    <div class="stamina-bar">
                        <div class="stamina-fill" id="staminaBar"></div>
                    </div>
                </div>
            </div>

            <div class="running-controls">
                <button class="btn primary running-btn" id="runBtn" onclick="runStep()">üèÉ‚Äç‚ôÄÔ∏è Îã¨Î¶¨Í∏∞!</button>
                <div class="instructions">
                    <p>üéØ Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÍ±∞ÎÇò Ïä§ÌéòÏù¥Ïä§Î∞îÎ•º Î¶¨Îì¨Ïóê ÎßûÏ∂∞ ÎàåÎü¨ÏÑú Îã¨Î¶¨ÏÑ∏Ïöî!</p>
                    <p>‚è∞ 1Ï¥à Í∞ÑÍ≤©ÏúºÎ°ú ÎàÑÎ•¥Îäî Í≤ÉÏù¥ Í∞ÄÏû• Ìö®Ïú®Ï†ÅÏù¥ÏóêÏöî!</p>
                    <p>‚ö†Ô∏è ÎÑàÎ¨¥ Îπ†Î•¥Í±∞ÎÇò ÎäêÎ¶¨Î©¥ Ïä§ÌÉúÎØ∏ÎÇòÍ∞Ä ÎßéÏù¥ Îñ®Ïñ¥Ï†∏Ïöî!</p>
                    <p>üèÅ 100m ÏôÑÏ£ºÎ•º Î™©ÌëúÎ°ú Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Í≤åÏûÑ ÌôîÎ©¥ -->
    <div id="gameScreen" class="screen">
        <div class="game-header">
            <h1 class="game-title">üéµ K-POP MATCH</h1>
            <button class="btn" onclick="goHome()" style="position: absolute; top: 20px; right: 20px;">ÌôàÏúºÎ°ú</button>
        </div>

        <div class="score-board">
            <div class="score-item">
                <div class="score-label">Ï†êÏàò</div>
                <div class="score-value" id="score">0</div>
                <div class="score-target" id="target">/ 3000</div>
            </div>
            <div class="score-item">
                <div class="score-label">ÏΩîÏù∏</div>
                <div class="score-value" id="coins">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">Î†àÎ≤®</div>
                <div class="score-value" id="level">1</div>
            </div>
            <div class="score-item">
                <div class="score-label">Ïù¥Îèô</div>
                <div class="score-value" id="moves">30</div>
            </div>
        </div>

        <div class="game-board">
            <div class="grid" id="gameGrid"></div>
        </div>

        <div class="game-controls">
            <button class="btn" onclick="shuffleBoard()">üîÄ ÏÑûÍ∏∞</button>
            <button class="btn" onclick="newGame()">üÜï ÏÉà Í≤åÏûÑ</button>
            <button class="btn" onclick="showHint()">üí° ÌûåÌä∏</button>
        </div>
    </div>

    <!-- Î¨¥ÎåÄ Îç∞Î∑î ÌôîÎ©¥ -->
    <div id="stageScreen" class="screen">
        <div class="game-header">
            <h1 class="game-title">üé§ Î¨¥ÎåÄ Îç∞Î∑î üé≠</h1>
            <button class="btn" onclick="goHome()" style="position: absolute; top: 20px; right: 20px;">üè† ÌôàÏúºÎ°ú</button>
        </div>

        <div class="stage-container">
            <!-- Î¨¥ÎåÄ Î∞∞Í≤Ω -->
            <div class="stage-backdrop">
                <div class="stage-lights"></div>
                <div class="stage-platform">
                    <!-- Í±∏Í∑∏Î£π Î©§Î≤ÑÎì§Ïù¥ Î¨¥ÎåÄÏóêÏÑú Í≥µÏó∞ -->
                    <div class="stage-members">
                        <div class="stage-member" data-member="0">
                            <div class="member-stage-avatar seoyeon-stage"></div>
                            <div class="member-stage-name">ÏÑúÏó∞</div>
                        </div>
                        <div class="stage-member center" data-member="1">
                            <div class="member-stage-avatar minji-stage"></div>
                            <div class="member-stage-name">ÎØºÏßÄ</div>
                        </div>
                        <div class="stage-member" data-member="2">
                            <div class="member-stage-avatar hayeon-stage"></div>
                            <div class="member-stage-name">ÌïòÏó∞</div>
                        </div>
                    </div>
                    
                    <!-- Í∞ÄÏÇ¨ -->
                    <div class="lyrics">
                        <div class="lyrics-container">
                            <div class="current-lyric" id="currentLyric">Ï§ÄÎπÑ Ï§ë...</div>
                            <div class="next-lyric" id="nextLyric"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Î∞∞Í≤ΩÏùåÏïÖ -->
            <audio id="performanceAudio" preload="auto" loop>
                <source src="./Res/starLightDance.mp3" type="audio/mpeg">
                <source src="./Res/starLightDance.ogg" type="audio/ogg">
            </audio>

            <!-- Í≥µÏó∞ ÏÉÅÌÉú UI -->
            <div class="performance-ui">
                <div class="performance-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="audienceScore">0</div>
                        <div class="stat-label">üë• Í¥ÄÍ∞ù Î∞òÏùë</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="performanceScore">0</div>
                        <div class="stat-label">üé≠ Í≥µÏó∞ Ï†êÏàò</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="albumSales">0</div>
                        <div class="stat-label">üíø Ïï®Î≤î ÌåêÎß§</div>
                    </div>
                </div>

                <!-- Í≥µÏó∞ Ï†úÏñ¥ -->
                <div class="performance-controls">
                    <button class="btn primary performance-btn" onclick="startPerformance()">
                        üé§ Í≥µÏó∞ ÏãúÏûë
                    </button>
                    <button class="btn" onclick="practicePerformance()" disabled>
                        üìù Ïó∞ÏäµÌïòÍ∏∞
                    </button>
                </div>

                <!-- Í≥µÏó∞ ÏßÑÌñâ ÏÉÅÌô© -->
                <div class="performance-progress" id="performanceProgress" style="display: none;">
                    <div class="progress-section">
                        <h3>üéµ Í≥° ÏßÑÌñâ</h3>
                        <div class="song-progress">
                            <div class="song-bar">
                                <div class="song-fill" id="songProgress"></div>
                            </div>
                            <div class="song-info">
                                <span id="currentSong">Starlight Dreams</span>
                                <span id="songTime">0:00 / 1:39</span>
                            </div>
                        </div>
                    </div>

                    <div class="live-reactions">
                        <h3>üíù Ïã§ÏãúÍ∞Ñ Î∞òÏùë</h3>
                        <div class="reaction-feed" id="reactionFeed">
                            <div class="reaction">üòç Ïö∞ÏôÄ ÎÑàÎ¨¥ Î©ãÏûàÏñ¥!</div>
                            <div class="reaction">üî• Î¨¥ÎåÄ ÏßÑÏßú Ï∞¢ÏóàÎã§!</div>
                            <div class="reaction">üíï ÏÑúÏó∞ ÌëúÏ†ï ÏôÑÎ≤ΩÌï¥!</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Í≤åÏûÑ ÏÉÅÌÉú Í¥ÄÎ¶¨
        let currentScreen = 'home';
        let playerData = {
            totalCoins: 0,
            completedLevels: 0,
            groupLevel: 1,
            members: [
                {
                    name: 'ÏÑúÏó∞',
                    level: 1,
                    hp: 65,        // Ï≤¥Î†•
                    emotion: 85,   // Í∞êÏÑ± - ÏÑúÏó∞Ïùò ÌäπÍ∏∞
                    vocal: 70,     // Î≥¥Ïª¨
                    dance: 55,     // ÎåÑÏä§
                    expression: 90, // ÌëúÏ†ï - ÏÑúÏó∞Ïùò ÏµúÍ≥† Îä•Î†•
                    power: 60      // ÌååÏõå
                },
                {
                    name: 'ÎØºÏßÄ',
                    level: 1,
                    hp: 75,        // Ï≤¥Î†•
                    emotion: 70,   // Í∞êÏÑ±
                    vocal: 95,     // Î≥¥Ïª¨ - ÎØºÏßÄÏùò ÌäπÍ∏∞ (Î©îÏù∏Î≥¥Ïª¨)
                    dance: 65,     // ÎåÑÏä§
                    expression: 75, // ÌëúÏ†ï
                    power: 90      // ÌååÏõå - ÏÑºÌÑ∞Ïùò Ïπ¥Î¶¨Ïä§Îßà
                },
                {
                    name: 'ÌïòÏó∞',
                    level: 1,
                    hp: 95,        // Ï≤¥Î†• - ÌïòÏó∞Ïùò ÌäπÍ∏∞ (ÎåÑÏÑú)
                    emotion: 80,   // Í∞êÏÑ±
                    vocal: 55,     // Î≥¥Ïª¨
                    dance: 100,    // ÎåÑÏä§ - ÌïòÏó∞Ïùò ÏµúÍ≥† Îä•Î†•
                    expression: 85, // ÌëúÏ†ï
                    power: 70      // ÌååÏõå
                }
            ]
        };

        // ÌôîÎ©¥ Ï†ÑÌôò
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            currentScreen = screenId;
        }

        function goHome() {
            showScreen('homeScreen');
            updateHomeUI();
        }

        function startGame() {
            showScreen('gameScreen');
            newGame();
        }

        function updateHomeUI() {
            document.getElementById('totalCoins').textContent = playerData.totalCoins;
            document.getElementById('completedLevels').textContent = playerData.completedLevels;
            document.getElementById('groupLevel').textContent = playerData.groupLevel;
        }

        // Î©§Î≤Ñ ÏÑ†ÌÉù Î∞è Î™®ÏÖò Ïû¨ÏÉù
        function selectMember(index) {
            const member = playerData.members[index];
            console.log(`${member.name} ÏÑ†ÌÉùÎê®`);
            console.log(`Î†àÎ≤®: ${member.level}`);
            console.log(`‚ù§Ô∏è Ï≤¥Î†•: ${member.hp}`);
            console.log(`üòä Í∞êÏÑ±: ${member.emotion}`);
            console.log(`üé§ Î≥¥Ïª¨: ${member.vocal}`);
            console.log(`üíÉ ÎåÑÏä§: ${member.dance}`);
            console.log(`üòç ÌëúÏ†ï: ${member.expression}`);
            console.log(`‚ö° ÌååÏõå: ${member.power}`);
            
            // Î™®ÏÖò ÎπÑÎîîÏò§ Ïû¨ÏÉù
            playMemberMotion(index);
            
            // Î©§Î≤ÑÎ≥Ñ ÏÉÅÏÑ∏ Ï†ïÎ≥¥ÎÇò ÌõàÎ†® Î©îÎâ¥ Îì±ÏùÑ Î≥¥Ïó¨Ï§Ñ Ïàò ÏûàÏùå
        }

        // Î©§Î≤Ñ Î™®ÏÖò ÎπÑÎîîÏò§ Ïû¨ÏÉù Ìï®Ïàò
        function playMemberMotion(memberIndex) {
            const memberElement = document.querySelector(`.member:nth-child(${memberIndex + 1})`);
            const videoElement = memberElement.querySelector('.motion-video');
            
            if (videoElement && videoElement.querySelector('source').src) {
                // ÎπÑÎîîÏò§Í∞Ä Ïù¥ÎØ∏ Ïû¨ÏÉù Ï§ëÏù¥Î©¥ Ï≤òÏùåÎ∂ÄÌÑ∞ Îã§Ïãú ÏãúÏûë
                videoElement.currentTime = 0;
                
                // ÎπÑÎîîÏò§Î•º Î≥¥Ïù¥Í≤å ÌïòÍ≥† Ïû¨ÏÉù
                videoElement.classList.add('playing');
                videoElement.play().catch(e => {
                    console.log('ÎπÑÎîîÏò§ Ïû¨ÏÉù Ïã§Ìå®:', e);
                    // ÎπÑÎîîÏò§ ÌååÏùºÏù¥ ÏóÜÏúºÎ©¥ CSS Ïï†ÎãàÎ©îÏù¥ÏÖòÏúºÎ°ú ÎåÄÏ≤¥
                    playFallbackAnimation(memberElement);
                });
                
                // ÎπÑÎîîÏò§ Ï¢ÖÎ£å Ïãú Ïà®Í∏∞Í∏∞
                videoElement.addEventListener('ended', function() {
                    videoElement.classList.remove('playing');
                }, { once: true });
                
                // 3Ï¥à ÌõÑ ÏûêÎèôÏúºÎ°ú Ïà®Í∏∞Í∏∞ (ÎπÑÎîîÏò§Í∞Ä Í∏∏ Í≤ΩÏö∞ ÎåÄÎπÑ)
                setTimeout(() => {
                    videoElement.classList.remove('playing');
                }, 3000);
            } else {
                // ÎπÑÎîîÏò§ ÌååÏùºÏù¥ ÏóÜÏúºÎ©¥ CSS Ïï†ÎãàÎ©îÏù¥ÏÖòÏúºÎ°ú ÎåÄÏ≤¥
                playFallbackAnimation(memberElement);
            }
        }

        // ÎπÑÎîîÏò§ ÌååÏùºÏù¥ ÏóÜÏùÑ Îïå ÎåÄÏ≤¥ Ïï†ÎãàÎ©îÏù¥ÏÖò
        function playFallbackAnimation(memberElement) {
            const avatar = memberElement.querySelector('.member-avatar');
            avatar.style.animation = 'memberClick 0.6s ease-out';
            
            setTimeout(() => {
                avatar.style.animation = '';
            }, 600);
        }

        // Î©îÎâ¥ Í∏∞Îä•Îì§
        function openTraining() {
            showScreen('trainingScreen');
        }

        function openShop() {
            alert('ÏÉÅÏ†ê Í∏∞Îä•ÏùÄ Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§! üõçÔ∏è');
        }

        // ===== Ïï®Î≤î Îç∞Î∑î ÏãúÏä§ÌÖú =====
        function startAlbumDebut() {
            // Í∑∏Î£π Î†àÎ≤® Ï≤¥ÌÅ¨ (5 Ïù¥ÏÉÅÏù¥Ïñ¥Ïïº Îç∞Î∑î Í∞ÄÎä•)
            if (playerData.groupLevel < 0) {
                alert(`üé§ Ïï®Î≤î Îç∞Î∑î Ï°∞Í±¥ ÎØ∏Îã¨!\n\nÌòÑÏû¨ Í∑∏Î£π Î†àÎ≤®: ${playerData.groupLevel}\nÌïÑÏöî Í∑∏Î£π Î†àÎ≤®: 5\n\nÎçî ÎßéÏùÄ Í≤åÏûÑÏùÑ ÌÅ¥Î¶¨Ïñ¥ÌïòÏó¨ Í∑∏Î£πÏùÑ ÏÑ±Ïû•ÏãúÌÇ§ÏÑ∏Ïöî!`);
                return;
            }

            // Î¨¥ÎåÄ ÌôîÎ©¥ÏúºÎ°ú Ïù¥Îèô
            showScreen('stageScreen');
        }

        function showDebutStage() {
            // Í∞ÑÎã®Ìïú Îç∞Î∑î Î¨¥ÎåÄ ÏãúÎÆ¨Î†àÏù¥ÏÖò
            let performanceScore = 0;
            let audienceReaction = 0;
            
            // Î©§Î≤ÑÎì§Ïùò Îä•Î†•ÏπòÎ•º Î∞îÌÉïÏúºÎ°ú Í≥µÏó∞ Ï†êÏàò Í≥ÑÏÇ∞
            playerData.members.forEach(member => {
                performanceScore += member.vocal * 0.3;
                performanceScore += member.dance * 0.3; 
                performanceScore += member.expression * 0.2;
                performanceScore += member.power * 0.2;
            });
            
            // Í∏∞Î≥∏ Ï†êÏàòÏóê ÎûúÎç§ ÏöîÏÜå Ï∂îÍ∞Ä
            performanceScore = Math.floor(performanceScore / 3);
            audienceReaction = Math.floor(performanceScore * 0.8) + Math.floor(Math.random() * 50);
            
            // Ïï®Î≤î ÌåêÎß§Îüâ Í≥ÑÏÇ∞
            const albumSales = Math.floor(performanceScore / 10) + Math.floor(audienceReaction / 15);
            
            // ÏΩîÏù∏ Î≥¥ÏÉÅ Í≥ÑÏÇ∞
            const coinReward = albumSales * 5;
            
            // Í≥µÏó∞ ÏãúÎÆ¨Î†àÏù¥ÏÖò Î©îÏãúÏßÄÎì§
            const performanceMessages = [
                "üé§ Î¨¥ÎåÄ ÏúÑÏóê Ïò¨ÎùºÏÑ† STARLIGHT GIRLS!",
                "‚ú® ÌôîÎ†§Ìïú Ï°∞Î™ÖÏù¥ Î©§Î≤ÑÎì§ÏùÑ ÎπÑÏ∂•ÎãàÎã§!",
                "üéµ Ï≤´ Í≥°Ïù¥ ÏãúÏûëÎêòÏóàÏäµÎãàÎã§!",
                "üë• Í¥ÄÍ∞ùÎì§Ïù¥ Ïó¥Í¥ëÌïòÍ≥† ÏûàÏäµÎãàÎã§!",
                "üíÉ ÏôÑÎ≤ΩÌïú ÎåÑÏä§ ÌçºÌè¨Î®ºÏä§!",
                "üé§ Í∞êÎèôÏ†ÅÏù∏ Î≥¥Ïª¨ ÌïòÎ™®Îãà!",
                "üëè Ïö∞Î†ÅÏ∞¨ Î∞ïÏàòÍ∞Ä ÏèüÏïÑÏßëÎãàÎã§!",
                "üåü Î¨¥ÎåÄÎ•º ÏôÑÏ†ÑÌûà Ïû•ÏïÖÌñàÏäµÎãàÎã§!"
            ];
            
            // ÏàúÏ∞®Ï†ÅÏúºÎ°ú Î©îÏãúÏßÄ ÌëúÏãú
            let messageIndex = 0;
            const showNextMessage = () => {
                if (messageIndex < performanceMessages.length) {
                    alert(performanceMessages[messageIndex]);
                    messageIndex++;
                    setTimeout(showNextMessage, 1000);
                } else {
                    // ÏµúÏ¢Ö Í≤∞Í≥º ÌëúÏãú
                    showDebutResults(performanceScore, audienceReaction, albumSales, coinReward);
                }
            };
            
            showNextMessage();
        }

        function showDebutResults(performanceScore, audienceReaction, albumSales, coinReward) {
            // ÏÑ±Í≥ºÏóê Îî∞Î•∏ Îì±Í∏â Í≤∞Ï†ï
            let grade = '';
            let gradeMessage = '';
            
            if (performanceScore >= 250) {
                grade = 'S';
                gradeMessage = 'üèÜ ÏôÑÎ≤ΩÌïú Îç∞Î∑î! Ï†ÑÏÑ§Ïùò ÏãúÏûëÏûÖÎãàÎã§!';
            } else if (performanceScore >= 200) {
                grade = 'A';
                gradeMessage = 'üåü ÌôòÏÉÅÏ†ÅÏù∏ Îç∞Î∑î! ÎåÄÏÑ±Í≥µÏûÖÎãàÎã§!';
            } else if (performanceScore >= 150) {
                grade = 'B';
                gradeMessage = '‚ú® ÌõåÎ•≠Ìïú Îç∞Î∑î! Ï¢ãÏùÄ Î∞òÏùëÏùÑ ÏñªÏóàÏäµÎãàÎã§!';
            } else if (performanceScore >= 100) {
                grade = 'C';
                gradeMessage = 'üëç ÏÑ±Í≥µÏ†ÅÏù∏ Îç∞Î∑î! ÏïûÏúºÎ°úÍ∞Ä Í∏∞ÎåÄÎê©ÎãàÎã§!';
            } else {
                grade = 'D';
                gradeMessage = 'üòÖ ÏïÑÏâ¨Ïö¥ Îç∞Î∑î... Îã§ÏùåÏóî Îçî ÏûòÌï† Ïàò ÏûàÏùÑ Í±∞ÏòàÏöî!';
            }
            
            // ÌîåÎ†àÏù¥Ïñ¥ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
            playerData.totalCoins += coinReward;
            
            // Î™®Îì† Î©§Î≤Ñ Îä•Î†•Ïπò ÏÜåÌè≠ Ï¶ùÍ∞Ä (Îç∞Î∑î Í≤ΩÌóò)
            playerData.members.forEach(member => {
                member.vocal = Math.min(member.vocal + 2, 100);
                member.dance = Math.min(member.dance + 2, 100);
                member.expression = Math.min(member.expression + 2, 100);
                member.power = Math.min(member.power + 2, 100);
            });
            
            updateMemberStats();
            updateHomeUI();
            
            // ÏµúÏ¢Ö Í≤∞Í≥º Î©îÏãúÏßÄ
            const resultMessage = `üéâ Ïï®Î≤î Îç∞Î∑î ÏôÑÎ£å! üéâ\n\n` +
                `üìä Îç∞Î∑î ÏÑ±Í≥º\n` +
                `üèÜ Îì±Í∏â: ${grade}\n` +
                `üé≠ Í≥µÏó∞ Ï†êÏàò: ${performanceScore}\n` +
                `üë• Í¥ÄÍ∞ù Î∞òÏùë: ${audienceReaction}\n` +
                `üíø Ïï®Î≤î ÌåêÎß§: ${albumSales}Ïû•\n` +
                `üí∞ ÌöçÎìù ÏΩîÏù∏: ${coinReward}\n\n` +
                `${gradeMessage}\n\n` +
                `‚ú® Î™®Îì† Î©§Î≤ÑÏùò Îä•Î†•ÏπòÍ∞Ä Ìñ•ÏÉÅÎêòÏóàÏäµÎãàÎã§!`;
            
            alert(resultMessage);
        }

        // ===== Î¨¥ÎåÄ Í≥µÏó∞ ÏãúÏä§ÌÖú (idol.htmlÏóêÏÑú Í∞ÄÏ†∏Ïò¥) =====
        let performanceData = {
            isPerforming: false,
            songDuration: 99,
            currentTime: 0,
            audienceScore: 0,
            performanceScore: 0,
            albumSales: 0,
            reactions: [
                'üòç Ïö∞ÏôÄ ÎÑàÎ¨¥ Î©ãÏûàÏñ¥!',
                'üî• Î¨¥ÎåÄ ÏßÑÏßú Ï∞¢ÏóàÎã§!',
                'üíï ÏÑúÏó∞ ÌëúÏ†ï ÏôÑÎ≤ΩÌï¥!',
                '‚ú® ÎØºÏßÄ ÏÑºÌÑ∞ ÎÑàÎ¨¥ Ï¢ãÏïÑ!',
                'üé§ ÌïòÏó∞ ÎåÑÏä§ ÎØ∏Ï≥§Îã§!',
                'üëè Î∞ïÏàò ÏèüÏïÑÏ†∏!',
                'üíñ ÏôÑÏ†Ñ ÏÇ¨ÎûëÌï¥!',
                'üéµ Ïù¥ ÎÖ∏Îûò ÎÑàÎ¨¥ Ï¢ãÏïÑ!',
                'üåü ÏßÑÏßú Ïä§ÌÉÄ Í∞ôÏïÑ!',
                'üí´ Î¨¥ÎåÄ Ïû•ÏïÖÎ†• ÎåÄÎ∞ï!'
            ],
            memberPerformance: [85, 92, 88], // ÏÑúÏó∞, ÎØºÏßÄ, ÌïòÏó∞ Í∏∞Î≥∏ ÏÑ±Îä•
            lyrics: [
                { time: 0, text: "üéµ Starlight Dreams üéµ", next: "Ïñ¥Îë† ÏÜçÏóê ÎπõÏù¥ Î≤àÏ†∏" },
                { time: 19, text: "Ïñ¥Îë† ÏÜçÏóê ÎπõÏù¥ Î≤àÏ†∏", next: "Î≥ÑÏù¥ Ï∂§Ï∂îÎäî Î∞§Ïùò Í±∞Î¶¨" },
                { time: 23, text: "Î≥ÑÏù¥ Ï∂§Ï∂îÎäî Î∞§Ïùò Í±∞Î¶¨", next: "Ìïú Í±∏ÏùåÏî© Îã§Í∞ÄÍ∞Ä Î¥ê" },
                { time: 26, text: "Ìïú Í±∏ÏùåÏî© Îã§Í∞ÄÍ∞Ä Î¥ê", next: "Ïã¨Ïû•Ïù¥ Îõ∞Ïñ¥ Îçî ÌÅ¨Í≤å Îõ∞Ïñ¥" },
                { time: 32, text: "Ïã¨Ïû•Ïù¥ Îõ∞Ïñ¥ Îçî ÌÅ¨Í≤å Îõ∞Ïñ¥", next: "‚ú® Î©àÏ∂ú Ïàò ÏóÜÏñ¥ Ïù¥ ÏàúÍ∞ÑÏùÑ Ïû°ÏïÑ ‚ú®" },
                { time: 40, text: "‚ú® Î©àÏ∂ú Ïàò ÏóÜÏñ¥ Ïù¥ ÏàúÍ∞ÑÏùÑ Ïû°ÏïÑ ‚ú®", next: "Î≥ÑÎπõ ÏÜçÏóê Ï∂§ÏùÑ Ï∂∞ Î∞òÏßùÏù¥Îäî Ïö∞Î¶¨ Î™®Ïäµ" },
                { time: 48, text: "Î≥ÑÎπõ ÏÜçÏóê Ï∂§ÏùÑ Ï∂∞ Î∞òÏßùÏù¥Îäî Ïö∞Î¶¨ Î™®Ïäµ", next: "Î©àÏ∂îÏßÄ Îßà Í≥ÑÏÜç Í∞Ä Ïù¥ Î∞§Ïù¥ ÎÅùÎÇ† ÎïåÍπåÏßÄ" },
                { time: 55, text: "Î©àÏ∂îÏßÄ Îßà Í≥ÑÏÜç Í∞Ä Ïù¥ Î∞§Ïù¥ ÎÅùÎÇ† ÎïåÍπåÏßÄ", next: "" },
                { time: 70, text: "", next: "" }
            ],
            currentLyricIndex: 0
        };

        function startPerformance() {
            if (performanceData.isPerforming) return;

            console.log("Î¨¥ÎåÄ Í≥µÏó∞ ÏãúÏûë!");
            performanceData.isPerforming = true;
            performanceData.currentTime = 0;
            performanceData.audienceScore = 0;
            performanceData.performanceScore = 0;
            performanceData.albumSales = 0;

            // Í∞ÄÏÇ¨ Ï¥àÍ∏∞Ìôî
            document.getElementById('currentLyric').textContent = "üéµ Starlight Dreams üéµ";
            document.getElementById('nextLyric').textContent = "Ïñ¥Îë† ÏÜçÏóê ÎπõÏù¥ Î≤àÏ†∏";

            // Î∞∞Í≤ΩÏùåÏïÖ Ïû¨ÏÉù ÏãúÎèÑ
            const audio = document.getElementById('performanceAudio');
            audio.volume = 0.6;
            audio.currentTime = 0;
            audio.play().catch(e => {
                console.log("Ïò§ÎîîÏò§ Ïû¨ÏÉù Ïã§Ìå®:", e);
            });

            // UI ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('performanceProgress').style.display = 'block';
            document.querySelector('.performance-btn').textContent = 'üé§ Í≥µÏó∞ Ï§ë...';
            document.querySelector('.performance-btn').disabled = true;

            // Î©§Î≤ÑÎì§ Í≥µÏó∞ ÏãúÏûë Ïï†ÎãàÎ©îÏù¥ÏÖò
            const members = document.querySelectorAll('.stage-member');
            members.forEach((member, index) => {
                setTimeout(() => {
                    member.classList.add('dancing');
                }, index * 200);
            });

            // Í≥µÏó∞ ÌÉÄÏù¥Î®∏ ÏãúÏûë
            const performanceTimer = setInterval(() => {
                if (!performanceData.isPerforming) {
                    clearInterval(performanceTimer);
                    return;
                }

                performanceData.currentTime++;
                updatePerformanceUI();

                // Ïã§ÏãúÍ∞Ñ Î∞òÏùë Ï∂îÍ∞Ä
                if (performanceData.currentTime % 2 === 0) {
                    addRandomReaction();
                }

                // Ï†êÏàò Í≥ÑÏÇ∞
                const scoreIncrease = calculatePerformanceScore();
                performanceData.performanceScore += scoreIncrease;
                performanceData.audienceScore += Math.floor(scoreIncrease * 0.8);

                // Í≥µÏó∞ Ï¢ÖÎ£å Ï≤¥ÌÅ¨
                if (performanceData.currentTime >= performanceData.songDuration) {
                    endPerformance();
                    clearInterval(performanceTimer);
                }
            }, 1000);
        }

        function calculatePerformanceScore() {
            const members = playerData.members;
            let totalScore = 0;

            members.forEach((member, index) => {
                const memberScore = (
                    member.vocal * 0.3 +
                    member.dance * 0.3 +
                    member.expression * 0.2 +
                    member.power * 0.2
                ) / 100;
                totalScore += memberScore;
            });

            const baseScore = Math.floor(totalScore * 3);
            const randomBonus = Math.floor(Math.random() * 3);
            
            return baseScore + randomBonus;
        }

        function updatePerformanceUI() {
            // ÏãúÍ∞Ñ ÏßÑÌñâÎ•†
            const progress = (performanceData.currentTime / performanceData.songDuration) * 100;
            document.getElementById('songProgress').style.width = progress + '%';

            // ÏãúÍ∞Ñ ÌëúÏãú
            const minutes = Math.floor(performanceData.currentTime / 60);
            const seconds = performanceData.currentTime % 60;
            const totalMinutes = Math.floor(performanceData.songDuration / 60);
            const totalSeconds = performanceData.songDuration % 60;
            
            document.getElementById('songTime').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')} / ${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;

            // Í∞ÄÏÇ¨ ÏóÖÎç∞Ïù¥Ìä∏
            updateLyrics();

            // Ï†êÏàò ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('audienceScore').textContent = performanceData.audienceScore;
            document.getElementById('performanceScore').textContent = performanceData.performanceScore;
            document.getElementById('albumSales').textContent = performanceData.albumSales;
        }

        function updateLyrics() {
            const currentTime = performanceData.currentTime;
            const lyrics = performanceData.lyrics;
            
            // ÌòÑÏû¨ ÏãúÍ∞ÑÏóê Ìï¥ÎãπÌïòÎäî Í∞ÄÏÇ¨ Ï∞æÍ∏∞
            let currentLyric = "";
            let nextLyric = "";
            
            for (let i = 0; i < lyrics.length; i++) {
                if (currentTime >= lyrics[i].time) {
                    currentLyric = lyrics[i].text;
                    nextLyric = lyrics[i].next;
                    
                    // Îã§Ïùå Í∞ÄÏÇ¨Í∞Ä Í≥ß ÎÇòÏò¨ ÏòàÏ†ïÏù∏ÏßÄ ÌôïÏù∏
                    if (i < lyrics.length - 1 && currentTime >= lyrics[i + 1].time - 2) {
                        nextLyric = lyrics[i + 1].text;
                    }
                } else {
                    break;
                }
            }
            
            // DOM ÏóÖÎç∞Ïù¥Ìä∏
            const currentLyricElement = document.getElementById('currentLyric');
            const nextLyricElement = document.getElementById('nextLyric');
            
            if (currentLyricElement) {
                currentLyricElement.textContent = currentLyric;
            }
            
            if (nextLyricElement) {
                nextLyricElement.textContent = nextLyric;
            }
        }

        async function addRandomReaction() {
            // AI ÏÉùÏÑ± Î¶¨Ïï°ÏÖòÍ≥º Í∏∞Î≥∏ Î¶¨Ïï°ÏÖò Ï§ë ÎûúÎç§ ÏÑ†ÌÉù (90% ÌôïÎ•†)
            if (Math.random() < 0.9) {
                await addAIGeneratedReaction();
            } else {
                addBasicReaction();
            }
        }

        function addBasicReaction() {
            const reactions = performanceData.reactions;
            const randomReaction = reactions[Math.floor(Math.random() * reactions.length)];
            
            addReactionToUI(randomReaction);
        }

        async function addAIGeneratedReaction() {
            try {
                const currentLyric = document.getElementById('currentLyric').textContent;
                const performanceScore = performanceData.performanceScore;
                const currentTime = performanceData.currentTime;
                
                // Í≥µÏó∞ ÏÉÅÌô©Ïóê ÎßûÎäî ÌîÑÎ°¨ÌîÑÌä∏ ÏÉùÏÑ±
                let context = "K-POP Í±∏Í∑∏Î£π STARLIGHT GIRLSÏùò Î¨¥ÎåÄ Í≥µÏó∞ Ï§ë";
                if (currentLyric && currentLyric.trim() !== "") {
                    context += `, ÌòÑÏû¨ Í∞ÄÏÇ¨: "${currentLyric}"`;
                }
                context += `, Í≥µÏó∞ Ï†êÏàò: ${performanceScore}, Í≥µÏó∞ ÏãúÍ∞Ñ: ${currentTime}Ï¥à`;
                
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer 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'
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo',
                        messages: [{
                            role: 'user',
                            content: `${context}ÏóêÏÑú Ìå¨Îì§Ïù¥ Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î≥¥ÎÇº Ïàò ÏûàÎäî ÏßßÍ≥† Í∞êÏ†ïÏ†ÅÏù∏ Î¶¨Ïï°ÏÖò Î©îÏãúÏßÄÎ•º ÌïúÍµ≠Ïñ¥Î°ú ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. ÎÑàÎ¨¥ Ï¢ãÎã§Í≥†Îßå ÌïòÏßÄÎßêÍ≥† ÏïàÏ¢ãÏùÄ Î∞òÏùëÎèÑ ÏûàÏóàÏúºÎ©¥ Ï¢ãÏùÑ Í≤É Í∞ôÎã§. Ïù¥Î™®ÏßÄÎ•º Ìè¨Ìï®ÌïòÍ≥† 20Ïûê Ïù¥ÎÇ¥Î°ú ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî. ÏòàÏãú: "üòç Ïö∞ÏôÄ ÎÑàÎ¨¥ Î©ãÏûàÏñ¥!", "üî• Î¨¥ÎåÄ Ï∞¢ÏóàÎã§!", "üíï ÏôÑÎ≤ΩÌï¥!"ÏôÄ Í∞ôÏùÄ Ïä§ÌÉÄÏùºÎ°ú.`
                        }],
                        max_tokens: 50,
                        temperature: 0.8
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    const aiReaction = data.choices[0].message.content.trim();
                    addReactionToUI(aiReaction);
                    console.log('AI ÏÉùÏÑ± Î¶¨Ïï°ÏÖò:', aiReaction);
                } else {
                    console.error('OpenAI API ÏóêÎü¨:', response.status);
                    addBasicReaction(); // Ïã§Ìå®Ïãú Í∏∞Î≥∏ Î¶¨Ïï°ÏÖò ÏÇ¨Ïö©
                }
            } catch (error) {
                console.error('AI Î¶¨Ïï°ÏÖò ÏÉùÏÑ± Ïã§Ìå®:', error);
                addBasicReaction(); // Ïã§Ìå®Ïãú Í∏∞Î≥∏ Î¶¨Ïï°ÏÖò ÏÇ¨Ïö©
            }
        }

        function addReactionToUI(reactionText) {
            const reactionFeed = document.getElementById('reactionFeed');
            const newReaction = document.createElement('div');
            newReaction.className = 'reaction';
            newReaction.textContent = reactionText;
            
            // ÏÉà Î∞òÏùëÏùÑ Îß® ÏúÑÏóê Ï∂îÍ∞Ä
            reactionFeed.insertBefore(newReaction, reactionFeed.firstChild);
            
            // Ïò§ÎûòÎêú Î∞òÏùë Ï†úÍ±∞ (ÏµúÎåÄ 5Í∞ú Ïú†ÏßÄ)
            while (reactionFeed.children.length > 5) {
                reactionFeed.removeChild(reactionFeed.lastChild);
            }

            // Í¥ÄÍ∞ù Ï†êÏàò ÏÜåÌè≠ Ï¶ùÍ∞Ä
            performanceData.audienceScore += Math.floor(Math.random() * 5) + 1;
        }

        function endPerformance() {
            console.log("Î¨¥ÎåÄ Í≥µÏó∞ Ï¢ÖÎ£å!");
            performanceData.isPerforming = false;

            // Î∞∞Í≤ΩÏùåÏïÖ Ï†ïÏßÄ
            const audio = document.getElementById('performanceAudio');
            audio.pause();
            audio.currentTime = 0;

            // Î©§Î≤Ñ Ïï†ÎãàÎ©îÏù¥ÏÖò Ï§ëÏßÄ
            const members = document.querySelectorAll('.stage-member');
            members.forEach(member => {
                member.classList.remove('dancing');
            });

            // ÏµúÏ¢Ö Ï†êÏàò Í≥ÑÏÇ∞
            const finalScore = performanceData.performanceScore;
            const finalAudienceScore = performanceData.audienceScore;
            
            // Ïï®Î≤î ÌåêÎß§Îüâ Í≥ÑÏÇ∞
            performanceData.albumSales = Math.floor(finalScore / 10) + Math.floor(finalAudienceScore / 15);

            // Í≤ΩÌóòÏπò Î∞è Î≥¥ÏÉÅ ÏßÄÍ∏â
            const coinReward = Math.floor(performanceData.albumSales * 5);

            // Î™®Îì† Î©§Î≤Ñ Í≤ΩÌóòÏπò Ï¶ùÍ∞Ä
            playerData.members.forEach(member => {
                member.vocal = Math.min(member.vocal + 1, 100);
                member.dance = Math.min(member.dance + 1, 100);
                member.expression = Math.min(member.expression + 1, 100);  
                member.power = Math.min(member.power + 1, 100);
            });

            // ÌîåÎ†àÏù¥Ïñ¥ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
            playerData.totalCoins += coinReward;
            updateMemberStats();

            // UI Î¶¨ÏÖã
            document.querySelector('.performance-btn').textContent = 'üé§ Í≥µÏó∞ ÏãúÏûë';
            document.querySelector('.performance-btn').disabled = false;

            // Í≤∞Í≥º Î©îÏãúÏßÄ
            setTimeout(() => {
                const message = `üéâ Í≥µÏó∞ ÏÑ±Í≥µ!\n\n` +
                    `üé≠ Í≥µÏó∞ Ï†êÏàò: ${finalScore}\n` +
                    `üë• Í¥ÄÍ∞ù Î∞òÏùë: ${finalAudienceScore}\n` +
                    `üíø Ïï®Î≤î ÌåêÎß§: ${performanceData.albumSales}Ïû•\n` +
                    `üí∞ ÌöçÎìù ÏΩîÏù∏: ${coinReward}\n\n` +
                    `‚ú® Î™®Îì† Î©§Î≤ÑÏùò Îä•Î†•ÏπòÍ∞Ä Ìñ•ÏÉÅÎêòÏóàÏäµÎãàÎã§!`;
                
                alert(message);
            }, 1000);
        }

        function practicePerformance() {
            alert('Ïó∞Ïäµ Í∏∞Îä•ÏùÄ Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§! üé≠');
        }

        // ===== Îã¨Î¶¨Í∏∞ Í≤åÏûÑ ÏãúÏä§ÌÖú =====
        let runningGame = {
            isPlaying: false,
            distance: 0,
            speed: 0,
            stamina: 100,
            targetRhythm: 1000, // 1Ï¥àÎßàÎã§ ÌÅ¥Î¶≠Ìï¥Ïïº Ìï®
            lastClickTime: 0,
            perfectClicks: 0,
            goodClicks: 0,
            badClicks: 0,
            totalClicks: 0
        };

        function startRunningGame() {
            showScreen('runningGameScreen');
            resetRunningGame();
        }

        function resetRunningGame() {
            runningGame = {
                isPlaying: true,
                distance: 0,
                speed: 0,
                stamina: 100,
                targetRhythm: 1000,
                lastClickTime: Date.now(),
                perfectClicks: 0,
                goodClicks: 0,
                badClicks: 0,
                totalClicks: 0
            };

            updateRunningUI();

            // Ïä§ÌÉúÎØ∏ÎÇò ÏûêÎèô Í∞êÏÜå
            const staminaTimer = setInterval(() => {
                if (!runningGame.isPlaying) {
                    clearInterval(staminaTimer);
                    return;
                }

                runningGame.stamina -= 0.3; // Ï°∞Í∏à Îçî Ï≤úÏ≤úÌûà Í∞êÏÜå
                if (runningGame.stamina <= 0) {
                    runningGame.stamina = 0;
                    endRunningGame();
                    clearInterval(staminaTimer);
                }

                updateRunningUI();
            }, 100);

            console.log("Îã¨Î¶¨Í∏∞ Í≤åÏûÑ ÏãúÏûë!");
        }

        function runStep() {
            if (!runningGame.isPlaying || runningGame.stamina <= 0) return;

            const currentTime = Date.now();
            const timeSinceLastClick = currentTime - runningGame.lastClickTime;
            const runBtn = document.getElementById('runBtn');
            const runner = document.getElementById('runner');

            // ÌÉÄÏù¥Î∞ç ÌåêÏ†ï
            let result = '';
            let speedIncrease = 0;
            let staminaCost = 0;

            if (timeSinceLastClick >= 800 && timeSinceLastClick <= 1200) {
                // Perfect ÌÉÄÏù¥Î∞ç (800ms - 1200ms)
                result = 'perfect';
                speedIncrease = 3;
                staminaCost = 2;
                runningGame.perfectClicks++;
            } else if (timeSinceLastClick >= 600 && timeSinceLastClick <= 1400) {
                // Good ÌÉÄÏù¥Î∞ç (600ms - 1400ms)
                result = 'good';
                speedIncrease = 2;
                staminaCost = 3;
                runningGame.goodClicks++;
            } else {
                // Bad ÌÉÄÏù¥Î∞ç
                result = 'bad';
                speedIncrease = 1;
                staminaCost = 5;
                runningGame.badClicks++;
            }

            // Î≤ÑÌäº Ìö®Í≥º
            runBtn.className = `btn primary running-btn ${result}`;
            setTimeout(() => {
                runBtn.className = 'btn primary running-btn';
            }, 300);

            // Îü¨ÎÑà Ïï†ÎãàÎ©îÏù¥ÏÖò
            runner.classList.add('running');
            setTimeout(() => {
                runner.classList.remove('running');
            }, 300);

            // Í≤åÏûÑ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
            runningGame.speed = speedIncrease;
            runningGame.distance += speedIncrease;
            runningGame.stamina -= staminaCost;
            runningGame.totalClicks++;
            runningGame.lastClickTime = currentTime;

            if (runningGame.stamina < 0) runningGame.stamina = 0;
            updateRunningUI();

            // 100m ÏôÑÏ£º Ï≤¥ÌÅ¨
            if (runningGame.distance >= 100) {
                endRunningGame();
            }

            console.log(`${result.toUpperCase()}! ÏÜçÎèÑ: ${speedIncrease}, Í±∞Î¶¨: ${runningGame.distance}m`);
        }

        function updateRunningUI() {
            document.getElementById('runDistance').textContent = Math.floor(runningGame.distance) + 'm';
            document.getElementById('runSpeed').textContent = runningGame.speed;
            document.getElementById('runStamina').textContent = Math.floor(runningGame.stamina);

            // ÏßÑÌñâÎ∞î ÏóÖÎç∞Ïù¥Ìä∏ (100m Í∏∞Ï§Ä)
            const progress = Math.min(runningGame.distance / 100 * 100, 100);
            document.getElementById('runProgress').style.width = progress + '%';

            // Ïä§ÌÉúÎØ∏ÎÇò Î∞î ÏóÖÎç∞Ïù¥Ìä∏
            const staminaBar = document.getElementById('staminaBar');
            const staminaPercent = Math.max(runningGame.stamina, 0);
            
            staminaBar.style.width = staminaPercent + '%';

            // Ïä§ÌÉúÎØ∏ÎÇò ÏàòÏ§ÄÏóê Îî∞Î•∏ ÏÉâÏÉÅ Î≥ÄÍ≤Ω
            staminaBar.className = 'stamina-fill';
            if (staminaPercent <= 10) {
                staminaBar.classList.add('critical');
            } else if (staminaPercent <= 25) {
                staminaBar.classList.add('low');
            } else if (staminaPercent <= 50) {
                staminaBar.classList.add('medium');
            }

            // Ïä§ÌÉúÎØ∏ÎÇòÍ∞Ä ÏúÑÌóò ÏàòÏ§ÄÏùº Îïå Ïπ¥Îìú Ï†ÑÏ≤¥ÎèÑ Í∞ïÏ°∞
            const staminaCard = staminaBar.closest('.stat-card');
            if (staminaPercent <= 25) {
                staminaCard.style.border = '2px solid #ff4757';
                staminaCard.style.boxShadow = '0 0 20px rgba(255,71,87,0.3)';
            } else {
                staminaCard.style.border = '1px solid rgba(255, 255, 255, 0.2)';
                staminaCard.style.boxShadow = 'none';
            }
        }

        function endRunningGame() {
            runningGame.isPlaying = false;

            // ÏÑ±Í≥º Í≥ÑÏÇ∞
            const totalClicks = runningGame.totalClicks;
            const successRate = totalClicks > 0 ? 
                (runningGame.perfectClicks * 2 + runningGame.goodClicks) / (totalClicks * 2) : 0;

            let hpIncrease = 0;
            let message = '';

            if (runningGame.distance >= 100) {
                // ÏôÑÏ£º ÏÑ±Í≥µ
                hpIncrease = Math.floor(3 + successRate * 5); // 3~8 Ï¶ùÍ∞Ä
                message = `üèÜ ÏôÑÏ£º ÏÑ±Í≥µ!\nÏ≤¥Î†• +${hpIncrease}\nÏÑ±Í≥µÎ•†: ${Math.floor(successRate * 100)}%`;
            } else if (runningGame.distance >= 50) {
                // Ï†àÎ∞ò Ïù¥ÏÉÅ
                hpIncrease = Math.floor(1 + successRate * 3); // 1~4 Ï¶ùÍ∞Ä
                message = `üëç Ï†àÎ∞ò Ïù¥ÏÉÅ ÏôÑÏ£º!\nÏ≤¥Î†• +${hpIncrease}\nÍ±∞Î¶¨: ${Math.floor(runningGame.distance)}m`;
            } else {
                // Ïã§Ìå®
                hpIncrease = 1;
                message = `üòÖ ÏïÑÏâΩÎÑ§Ïöî!\nÏ≤¥Î†• +${hpIncrease}\nÍ±∞Î¶¨: ${Math.floor(runningGame.distance)}m`;
            }

            // Î™®Îì† Î©§Î≤ÑÏùò Ï≤¥Î†• Ï¶ùÍ∞Ä
            playerData.members.forEach(member => {
                member.hp = Math.min(member.hp + hpIncrease, 100);
            });

            updateMemberStats();

            setTimeout(() => {
                alert(message);
                showScreen('trainingScreen');
            }, 1000);

            console.log(`Í≤åÏûÑ Ï¢ÖÎ£å: ${message}`);
        }

        function exitRunningGame() {
            runningGame.isPlaying = false;
            showScreen('trainingScreen');
        }

        function updateMemberStats() {
            // Ìôà ÌôîÎ©¥Ïùò Ïä§ÌÉØ Î∞î ÏóÖÎç∞Ïù¥Ìä∏
            const members = ['seoyeon', 'minji', 'hayeon'];
            playerData.members.forEach((member, index) => {
                const memberPrefix = members[index];
                document.getElementById(`${memberPrefix}-hp`).style.width = member.hp + '%';
                document.getElementById(`${memberPrefix}-emotion`).style.width = member.emotion + '%';
                document.getElementById(`${memberPrefix}-vocal`).style.width = member.vocal + '%';
                document.getElementById(`${memberPrefix}-dance`).style.width = member.dance + '%';
                document.getElementById(`${memberPrefix}-expression`).style.width = member.expression + '%';
                document.getElementById(`${memberPrefix}-power`).style.width = member.power + '%';
            });
        }

        // === Îß§Ïπò3 Í≤åÏûÑ Î°úÏßÅ ===
        const BLOCK_TYPES = [
            { symbol: 'üé§', class: 'mic', name: 'ÎßàÏù¥ÌÅ¨' },
            { symbol: 'üéß', class: 'headphones', name: 'Ìó§ÎìúÌè∞' },
            { symbol: 'üéá', class: 'lightstick', name: 'ÏùëÏõêÎ¥â' },
            { symbol: 'üéµ', class: 'note', name: 'ÏùåÌëú' }
        ];

        let gameBoard = [];
        let selectedCell = null;
        let score = 0;
        let coins = 0;
        let level = 1;
        let moves = 30;
        let isAnimating = false;
        let isDragging = false;
        let dragStartCell = null;
        let mouseStartX = 0;
        let mouseStartY = 0;
        let dragThreshold = 30;

        const levelTargets = {
            1: 3000,
            2: 5000,
            3: 7000
        };

        function initGame() {
            gameBoard = [];
            do {
                for (let i = 0; i < 8; i++) {
                    gameBoard[i] = [];
                    for (let j = 0; j < 8; j++) {
                        gameBoard[i][j] = Math.floor(Math.random() * BLOCK_TYPES.length);
                    }
                }
            } while (findMatches().length > 0);

            renderBoard();
            console.log("Í≤åÏûÑ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å");
        }

        function renderBoard() {
            const grid = document.getElementById('gameGrid');
            grid.innerHTML = '';

            for (let i = 0; i < 8; i++) {
                for (let j = 0; j < 8; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.row = i;
                    cell.dataset.col = j;

                    const blockType = BLOCK_TYPES[gameBoard[i][j]];
                    const block = document.createElement('div');
                    block.className = `block ${blockType.class}`;
                    // Ïã¨Î≥º ÏÜçÏÑ± Î∞è ÌÖçÏä§Ìä∏ ÏÑ§Ï†ï ÏôÑÏ†ÑÌûà Ï†úÍ±∞

                    cell.appendChild(block);

                    cell.addEventListener('mousedown', handleMouseDown);
                    cell.addEventListener('touchstart', handleTouchStart, { passive: false });

                    if (Math.random() < 0.1) {
                        addSparkle(cell);
                    }

                    grid.appendChild(cell);
                }
            }
        }

        function addSparkle(cell) {
            setTimeout(() => {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = Math.random() * 50 + 'px';
                sparkle.style.top = Math.random() * 50 + 'px';
                cell.appendChild(sparkle);

                setTimeout(() => {
                    if (sparkle.parentNode) {
                        sparkle.parentNode.removeChild(sparkle);
                    }
                }, 1000);
            }, Math.random() * 3000);
        }

        // ÎìúÎûòÍ∑∏ Ìï∏Îì§Îü¨Îì§
        function handleMouseDown(e) {
            if (isAnimating) return;

            e.preventDefault();
            isDragging = false;

            dragStartCell = {
                row: parseInt(e.target.closest('.cell').dataset.row),
                col: parseInt(e.target.closest('.cell').dataset.col)
            };

            mouseStartX = e.clientX;
            mouseStartY = e.clientY;

            e.target.closest('.cell').classList.add('drag-start');

            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);

            console.log(`ÎìúÎûòÍ∑∏ Ï§ÄÎπÑ: (${dragStartCell.row}, ${dragStartCell.col})`);
        }

        function handleTouchStart(e) {
            if (isAnimating) return;

            e.preventDefault();
            isDragging = false;

            const touch = e.touches[0];
            dragStartCell = {
                row: parseInt(e.target.closest('.cell').dataset.row),
                col: parseInt(e.target.closest('.cell').dataset.col)
            };

            mouseStartX = touch.clientX;
            mouseStartY = touch.clientY;

            e.target.closest('.cell').classList.add('drag-start');

            document.addEventListener('touchmove', handleTouchMove, { passive: false });
            document.addEventListener('touchend', handleTouchEnd);
        }

        function handleMouseMove(e) {
            if (!dragStartCell) return;

            const deltaX = e.clientX - mouseStartX;
            const deltaY = e.clientY - mouseStartY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);

            if (distance > dragThreshold && !isDragging) {
                isDragging = true;
                document.querySelector(`[data-row="${dragStartCell.row}"][data-col="${dragStartCell.col}"]`).classList.add('dragging');
            }

            if (isDragging) {
                checkDragDirection(deltaX, deltaY);
            }
        }

        function handleTouchMove(e) {
            if (!dragStartCell) return;

            e.preventDefault();
            const touch = e.touches[0];
            const deltaX = touch.clientX - mouseStartX;
            const deltaY = touch.clientY - mouseStartY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);

            if (distance > dragThreshold && !isDragging) {
                isDragging = true;
                document.querySelector(`[data-row="${dragStartCell.row}"][data-col="${dragStartCell.col}"]`).classList.add('dragging');
            }

            if (isDragging) {
                checkDragDirection(deltaX, deltaY);
            }
        }

        function checkDragDirection(deltaX, deltaY) {
            let targetRow = dragStartCell.row;
            let targetCol = dragStartCell.col;

            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                if (deltaX > 0 && dragStartCell.col < 7) {
                    targetCol = dragStartCell.col + 1;
                } else if (deltaX < 0 && dragStartCell.col > 0) {
                    targetCol = dragStartCell.col - 1;
                }
            } else {
                if (deltaY > 0 && dragStartCell.row < 7) {
                    targetRow = dragStartCell.row + 1;
                } else if (deltaY < 0 && dragStartCell.row > 0) {
                    targetRow = dragStartCell.row - 1;
                }
            }

            document.querySelectorAll('.drag-target').forEach(cell => {
                cell.classList.remove('drag-target');
            });

            if (targetRow !== dragStartCell.row || targetCol !== dragStartCell.col) {
                const targetCell = document.querySelector(`[data-row="${targetRow}"][data-col="${targetCol}"]`);
                if (targetCell) {
                    targetCell.classList.add('drag-target');
                }
            }
        }

        function handleMouseUp(e) {
            finishDrag();
        }

        function handleTouchEnd(e) {
            finishDrag();
        }

        function finishDrag() {
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('mouseup', handleMouseUp);
            document.removeEventListener('touchmove', handleTouchMove);
            document.removeEventListener('touchend', handleTouchEnd);

            if (isDragging && dragStartCell) {
                const targetCell = document.querySelector('.drag-target');
                if (targetCell) {
                    const targetRow = parseInt(targetCell.dataset.row);
                    const targetCol = parseInt(targetCell.dataset.col);

                    console.log(`Î∏îÎ°ù Ïù¥Îèô: (${dragStartCell.row}, ${dragStartCell.col}) -> (${targetRow}, ${targetCol})`);

                    swapBlocks(dragStartCell.row, dragStartCell.col, targetRow, targetCol);
                }
            }

            document.querySelectorAll('.drag-start, .dragging, .drag-target').forEach(cell => {
                cell.classList.remove('drag-start', 'dragging', 'drag-target');
            });

            isDragging = false;
            dragStartCell = null;
        }

        function isAdjacent(row1, col1, row2, col2) {
            const rowDiff = Math.abs(row1 - row2);
            const colDiff = Math.abs(col1 - col2);
            return (rowDiff === 1 && colDiff === 0) || (rowDiff === 0 && colDiff === 1);
        }

        function swapBlocks(row1, col1, row2, col2) {
            console.log(`Î∏îÎ°ù ÍµêÌôò ÏãúÎèÑ: (${row1},${col1}) <-> (${row2},${col2})`);
            console.log(`ÍµêÌôò Ï†Ñ: ${gameBoard[row1][col1]} <-> ${gameBoard[row2][col2]}`);

            const temp = gameBoard[row1][col1];
            gameBoard[row1][col1] = gameBoard[row2][col2];
            gameBoard[row2][col2] = temp;

            const matches = findMatches();
            console.log(`Îß§Ïπò ÌôïÏù∏ Í≤∞Í≥º: ${matches.length}Í∞ú Îß§Ïπò Î∞úÍ≤¨`);

            if (matches.length > 0) {
                moves--;
                console.log("Îß§Ïπò ÏÑ±Í≥µ! Ïù¥ÌéôÌä∏ÏôÄ Ìï®Íªò Ï†úÍ±∞");
                renderBoard();
                updateScore();
                setTimeout(() => {
                    removeMatches(matches);
                }, 100);
            } else {
                console.log("Îß§Ïπò ÏóÜÏùå - ÏõêÎûòÎåÄÎ°ú Î≥µÍµ¨");
                const temp = gameBoard[row1][col1];
                gameBoard[row1][col1] = gameBoard[row2][col2];
                gameBoard[row2][col2] = temp;
                renderBoard();
                updateScore();

                const targetScore = levelTargets[level];
                console.log(`Í∞ïÏ†ú Í≤åÏûÑ Ï¢ÖÎ£å Ï≤¥ÌÅ¨: ÌòÑÏû¨Ï†êÏàò=${score}, Î™©ÌëúÏ†êÏàò=${targetScore}, Î†àÎ≤®=${level}, ÎÇ®ÏùÄÏù¥Îèô=${moves}`);

                if (score >= targetScore) {
                    console.log("üéâ Î†àÎ≤® ÌÅ¥Î¶¨Ïñ¥ Ï°∞Í±¥ Îã¨ÏÑ±!");
                    setTimeout(() => {
                        levelClearToHome();
                    }, 500);
                } else if (moves <= 0) {
                    console.log("üíÄ Í≤åÏûÑ Ïò§Î≤Ñ - Ïù¥Îèô ÌöüÏàò Î∂ÄÏ°±");
                    setTimeout(() => {
                        alert(`Í≤åÏûÑ Ï¢ÖÎ£å!\nÎã¨ÏÑ± Ï†êÏàò: ${score} / ${targetScore}\nÌöçÎìù ÏΩîÏù∏: ${coins}\n\nÎã§Ïãú ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!`);
                        newGame();
                    }, 500);
                }
            }
        }

        function findMatches() {
            const matches = [];

            for (let i = 0; i < 8; i++) {
                for (let j = 0; j < 6; j++) {
                    if (gameBoard[i][j] === gameBoard[i][j+1] && gameBoard[i][j] === gameBoard[i][j+2]) {
                        const match = [{row: i, col: j}, {row: i, col: j+1}, {row: i, col: j+2}];
                        for (let k = j+3; k < 8 && gameBoard[i][k] === gameBoard[i][j]; k++) {
                            match.push({row: i, col: k});
                        }
                        matches.push(match);
                        j += match.length - 1;
                    }
                }
            }

            for (let j = 0; j < 8; j++) {
                for (let i = 0; i < 6; i++) {
                    if (gameBoard[i][j] === gameBoard[i+1][j] && gameBoard[i][j] === gameBoard[i+2][j]) {
                        const match = [{row: i, col: j}, {row: i+1, col: j}, {row: i+2, col: j}];
                        for (let k = i+3; k < 8 && gameBoard[k][j] === gameBoard[i][j]; k++) {
                            match.push({row: k, col: j});
                        }
                        matches.push(match);
                        i += match.length - 1;
                    }
                }
            }

            return matches;
        }

        function removeMatches(matches) {
            isAnimating = true;
            console.log("Îß§Ïπò Ï≤òÎ¶¨ ÏãúÏûë:", matches);

            const flash = document.createElement('div');
            flash.className = 'screen-flash';
            document.body.appendChild(flash);
            setTimeout(() => document.body.removeChild(flash), 400);

            matches.forEach((match, matchIndex) => {
                console.log(`Îß§Ïπò ${matchIndex + 1}: ${match.length}Í∞ú Î∏îÎ°ù`);

                match.forEach((pos, cellIndex) => {
                    const cell = document.querySelector(`[data-row="${pos.row}"][data-col="${pos.col}"]`);

                    cell.classList.add('destroying');

                    setTimeout(() => {
                        const explosion = document.createElement('div');
                        explosion.className = 'match-effect match-explosion';
                        cell.appendChild(explosion);

                        for (let i = 1; i <= 8; i++) {
                            const sparkle = document.createElement('div');
                            sparkle.className = `sparkle-burst sparkle-${i}`;
                            cell.appendChild(sparkle);
                        }

                        setTimeout(() => {
                            if (explosion.parentNode) explosion.parentNode.removeChild(explosion);
                            cell.querySelectorAll('.sparkle-burst').forEach(sparkle => {
                                if (sparkle.parentNode) sparkle.parentNode.removeChild(sparkle);
                            });
                        }, 800);
                    }, cellIndex * 50);
                });
            });

            setTimeout(() => {
                matches.forEach((match, matchIndex) => {
                    console.log(`Îß§Ïπò ${matchIndex + 1} Ï≤òÎ¶¨ Ï§ë: ${match.length}Í∞ú`);

                    match.forEach(pos => {
                        gameBoard[pos.row][pos.col] = -1;
                    });

                    const scoreGained = match.length * 100 * level;
                    score += scoreGained;
                    console.log(`Ï†êÏàò ÌöçÎìù: +${scoreGained} (Ï¥ù: ${score})`);

                    if (match.length >= 4) {
                        const coinsEarned = match.length;
                        coins += coinsEarned;
                        console.log(`üéâ ${match.length}Í∞ú Îß§Ïπò! ${coinsEarned}ÏΩîÏù∏ ÌöçÎìù! (Ï¥ù ÏΩîÏù∏: ${coins})`);

                        document.getElementById('coins').textContent = coins;
                        document.getElementById('coins').style.color = '#00ff00';
                        setTimeout(() => {
                            document.getElementById('coins').style.color = '#ffd700';
                        }, 500);

                        showCoinEffect(match, coinsEarned);
                    } else {
                        console.log(`3Í∞ú Îß§Ïπò - ÏΩîÏù∏ ÏóÜÏùå`);
                    }
                });

                document.querySelectorAll('.destroying').forEach(cell => {
                    cell.classList.remove('destroying');
                });

                dropBlocks();
                fillEmpty();
                renderBoard();
                updateScore();

                setTimeout(() => {
                    const newMatches = findMatches();
                    if (newMatches.length > 0) {
                        removeMatches(newMatches);
                    } else {
                        isAnimating = false;
                        console.log("Ïó∞ÏáÑ Îß§Ïπò ÎÅù - ÏµúÏ¢Ö Í≤åÏûÑ Ï¢ÖÎ£å Ï≤¥ÌÅ¨");
                        const targetScore = levelTargets[level];
                        console.log(`Í∞ïÏ†ú Í≤åÏûÑ Ï¢ÖÎ£å Ï≤¥ÌÅ¨: ÌòÑÏû¨Ï†êÏàò=${score}, Î™©ÌëúÏ†êÏàò=${targetScore}, Î†àÎ≤®=${level}, ÎÇ®ÏùÄÏù¥Îèô=${moves}`);

                        if (score >= targetScore) {
                            console.log("üéâ Î†àÎ≤® ÌÅ¥Î¶¨Ïñ¥ Ï°∞Í±¥ Îã¨ÏÑ±!");
                            setTimeout(() => {
                                levelClearToHome();
                            }, 500);
                        } else if (moves <= 0) {
                            console.log("üíÄ Í≤åÏûÑ Ïò§Î≤Ñ - Ïù¥Îèô ÌöüÏàò Î∂ÄÏ°±");
                            setTimeout(() => {
                                alert(`Í≤åÏûÑ Ï¢ÖÎ£å!\nÎã¨ÏÑ± Ï†êÏàò: ${score} / ${targetScore}\nÌöçÎìù ÏΩîÏù∏: ${coins}\n\nÎã§Ïãú ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!`);
                                newGame();
                            }, 500);
                        } else {
                            console.log("Í≤åÏûÑ Í≥ÑÏÜç ÏßÑÌñâ");
                        }
                    }
                }, 300);
            }, 800);
        }

        function showCoinEffect(match, coinsEarned) {
            const firstCell = match[0];
            const cellElement = document.querySelector(`[data-row="${firstCell.row}"][data-col="${firstCell.col}"]`);

            if (cellElement) {
                const coinEffect = document.createElement('div');
                coinEffect.className = 'coin-effect';
                coinEffect.textContent = `+${coinsEarned} üí∞`;

                const rect = cellElement.getBoundingClientRect();
                coinEffect.style.position = 'fixed';
                coinEffect.style.left = (rect.left + rect.width/2) + 'px';
                coinEffect.style.top = (rect.top + rect.height/2) + 'px';
                coinEffect.style.transform = 'translate(-50%, -50%)';

                document.body.appendChild(coinEffect);

                setTimeout(() => {
                    if (coinEffect.parentNode) {
                        coinEffect.parentNode.removeChild(coinEffect);
                    }
                }, 1500);
            }
        }

        // Î†àÎ≤® ÌÅ¥Î¶¨Ïñ¥ Ïãú ÌôàÏúºÎ°ú Ïù¥Îèô
        function levelClearToHome() {
            console.log("Î†àÎ≤® ÌÅ¥Î¶¨Ïñ¥ ÌôîÎ©¥ ÏÉùÏÑ± ÏãúÏûë");
            const overlay = document.createElement('div');
            overlay.className = 'clear-overlay';

            const clearMessage = document.createElement('div');
            clearMessage.className = 'clear-message';

            const title = document.createElement('h1');
            title.className = 'clear-title';
            title.textContent = 'CLEAR!';

            const stats = document.createElement('div');
            stats.className = 'clear-stats';
            stats.innerHTML = `
                <div>üéâ Î†àÎ≤® ${level} ÌÅ¥Î¶¨Ïñ¥!</div>
                <div>üéØ ÌöçÎìù Ï†êÏàò: ${score}Ï†ê</div>
                <div>üí∞ ÌöçÎìù ÏΩîÏù∏: ${coins}Í∞ú</div>
            `;

            const homeButton = document.createElement('button');
            homeButton.className = 'clear-button';
            homeButton.textContent = 'üè† ÌôàÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞';
            homeButton.onclick = () => {
                console.log("Ìôà Î≤ÑÌäº ÌÅ¥Î¶≠");
                document.body.removeChild(overlay);

                // ÌîåÎ†àÏù¥Ïñ¥ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                playerData.totalCoins += coins;
                playerData.completedLevels = Math.max(playerData.completedLevels, level);

                // ÌôàÏúºÎ°ú Ïù¥Îèô
                goHome();
            };

            clearMessage.appendChild(title);
            clearMessage.appendChild(stats);
            clearMessage.appendChild(homeButton);
            overlay.appendChild(clearMessage);
            document.body.appendChild(overlay);

            console.log("Î†àÎ≤® ÌÅ¥Î¶¨Ïñ¥ ÌôîÎ©¥ DOMÏóê Ï∂îÍ∞Ä ÏôÑÎ£å");
        }

        function dropBlocks() {
            for (let j = 0; j < 8; j++) {
                let writeIndex = 7;
                for (let i = 7; i >= 0; i--) {
                    if (gameBoard[i][j] !== -1) {
                        gameBoard[writeIndex][j] = gameBoard[i][j];
                        if (writeIndex !== i) {
                            gameBoard[i][j] = -1;
                        }
                        writeIndex--;
                    }
                }
            }
        }

        function fillEmpty() {
            for (let i = 0; i < 8; i++) {
                for (let j = 0; j < 8; j++) {
                    if (gameBoard[i][j] === -1) {
                        gameBoard[i][j] = Math.floor(Math.random() * BLOCK_TYPES.length);
                    }
                }
            }
        }

        function updateScore() {
            console.log(`Ï†êÏàò ÏóÖÎç∞Ïù¥Ìä∏: Ï†êÏàò=${score}, ÏΩîÏù∏=${coins}, Î†àÎ≤®=${level}`);

            const scoreElement = document.getElementById('score');
            const coinsElement = document.getElementById('coins');
            const levelElement = document.getElementById('level');
            const movesElement = document.getElementById('moves');
            const targetElement = document.getElementById('target');

            if (scoreElement) scoreElement.textContent = score;
            if (coinsElement) {
                coinsElement.textContent = coins;
                console.log(`ÏΩîÏù∏ UI ÏóÖÎç∞Ïù¥Ìä∏: ${coins}`);
            }
            if (levelElement) levelElement.textContent = level;
            if (movesElement) movesElement.textContent = moves;

            const targetScore = levelTargets[level] || 7000;
            if (targetElement) targetElement.textContent = `/ ${targetScore}`;

            document.body.offsetHeight;
        }

        function newGame() {
            score = 0;
            coins = 0;
            level = 1;
            moves = 30;
            selectedCell = null;
            isAnimating = false;
            updateScore();
            initGame();
        }

        function shuffleBoard() {
            if (moves > 0) {
                moves--;
                for (let i = 0; i < 8; i++) {
                    for (let j = 0; j < 8; j++) {
                        gameBoard[i][j] = Math.floor(Math.random() * BLOCK_TYPES.length);
                    }
                }
                renderBoard();
                updateScore();
            }
        }

        function showHint() {
            if (moves > 0) {
                moves--;
                updateScore();
                const row = Math.floor(Math.random() * 8);
                const col = Math.floor(Math.random() * 8);
                const hintCell = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                hintCell.style.boxShadow = '0 0 20px #ffd700';

                setTimeout(() => {
                    hintCell.style.boxShadow = '';
                }, 2000);
            }
        }

        // Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ Í¥ÄÎ¶¨
        function showSplashScreen() {
            // Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ ÌëúÏãú
            document.getElementById('splashScreen').style.display = 'flex';
            
            // Ìôà ÌôîÎ©¥ Ïà®Í∏∞Í∏∞
            document.getElementById('homeScreen').classList.remove('active');
            
            // 3Ï¥à ÌõÑ Ìôà ÌôîÎ©¥ÏúºÎ°ú Ï†ÑÌôò
            setTimeout(() => {
                hideSplashScreen();
            }, 3000);
        }

        function hideSplashScreen() {
            const splashScreen = document.getElementById('splashScreen');
            
            // ÌéòÏù¥Îìú ÏïÑÏõÉ Ìö®Í≥º
            splashScreen.classList.add('fade-out');
            
            // Ïï†ÎãàÎ©îÏù¥ÏÖò ÏôÑÎ£å ÌõÑ Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ Ï†úÍ±∞ Î∞è Ìôà ÌôîÎ©¥ ÌëúÏãú
            setTimeout(() => {
                splashScreen.style.display = 'none';
                document.getElementById('homeScreen').classList.add('active');
                currentScreen = 'homeScreen';
            }, 500);
        }

        // Ïï± Ï¥àÍ∏∞Ìôî Î∞è Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ ÌëúÏãú
        function initApp() {
            // Í≤åÏûÑ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
            updateHomeUI();
            updateMemberStats();
            
            // Ïä§ÌîåÎûòÏãú ÌôîÎ©¥ ÌëúÏãú
            showSplashScreen();
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïï± Ï¥àÍ∏∞Ìôî
        window.addEventListener('load', initApp);

        // ÌÇ§Î≥¥Îìú Ïù¥Î≤§Ìä∏ (Îã¨Î¶¨Í∏∞ Í≤åÏûÑÏö©)
        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space' && currentScreen === 'runningGameScreen') {
                e.preventDefault();
                runStep();
            }
        });
    </script>
</body>
</html>